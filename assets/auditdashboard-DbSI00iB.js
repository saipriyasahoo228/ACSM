import{j as e,r as E,R}from"./index-DeCPM1YT.js";import{u as a,w as f}from"./xlsx-CQK9p-uP.js";import{f as h,B as p,T as r,C as x,a as A,b as g,c as d,d as t,e as C}from"./TableRow-Cd9L6edy.js";import{S as b}from"./Stack-Cb_zqfoO.js";import{C as T}from"./CardHeader-BFOCdbev.js";import{B as w}from"./Button-i0LS_vGv.js";import{C as H}from"./CardContent-DuW-pjc9.js";import{I as M}from"./IconButton-oK9S63L7.js";import{E as B}from"./ExpandLess-BUkRJSnp.js";import{E as V}from"./ExpandMore-BjBxeS2K.js";import{C as j}from"./Chip-D7PQ2JTP.js";import{C as W}from"./Collapse-CI6k5Tak.js";import"./clsx-B-dksMZM.js";import"./ButtonBase-Cikulz_k.js";import"./TransitionGroupContext-CNIvG2Vj.js";import"./Transition-B84HZYJ-.js";const L=h(e.jsx("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M9 17H7v-7h2zm4 0h-2V7h2zm4 0h-2v-4h2z"})),O=h(e.jsx("path",{fillRule:"evenodd",d:"M20 3H4c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2M10 17H5v-2h5zm0-4H5v-2h5zm0-4H5V7h5zm4.82 6L12 12.16l1.41-1.41 1.41 1.42L17.99 9l1.42 1.42z"})),y=h(e.jsx("path",{d:"M19 9h-4V3H9v6H5l7 7zM5 18v2h14v-2z"})),v=h(e.jsx("path",{d:"m23 12-2.44-2.79.34-3.69-3.61-.82-1.89-3.2L12 2.96 8.6 1.5 6.71 4.69 3.1 5.5l.34 3.7L1 12l2.44 2.79-.34 3.7 3.61.82L8.6 22.5l3.4-1.47 3.4 1.46 1.89-3.19 3.61-.82-.34-3.69zm-12.91 4.72-3.8-3.81 1.48-1.48 2.32 2.33 5.85-5.87 1.48 1.48z"})),c=[{id:"IA-001",type:"Internal",site:"Plant A",auditor:"Ravi Kumar",date:"2025-09-15",nonCompliances:2,capasCompleted:1,totalCapas:3,capas:[{id:"C-001",description:"Replace safety signages",status:"Completed",owner:"Ajay"},{id:"C-002",description:"Check wiring connections",status:"Pending",owner:"Rahul"},{id:"C-003",description:"Update PPE checklist",status:"Pending",owner:"Kiran"}]},{id:"EA-001",type:"External",site:"Plant B",auditor:"DNV Agency",date:"2025-10-02",nonCompliances:1,capasCompleted:1,totalCapas:1,capas:[{id:"C-004",description:"Replace fire extinguisher",status:"Completed",owner:"Sita"}]},{id:"IA-002",type:"Internal",site:"Plant B",auditor:"Manoj Sahu",date:"2025-09-20",nonCompliances:0,capasCompleted:0,totalCapas:0,capas:[]}],ie=()=>{const[m,S]=E.useState([]),z=s=>{S(n=>n.includes(s)?n.filter(o=>o!==s):[...n,s])},D=s=>{const n=s.capas.map(l=>({AuditID:s.id,Type:s.type,Site:s.site,Auditor:s.auditor,AuditDate:s.date,CAPA_ID:l.id,Description:l.description,Status:l.status,Owner:l.owner})),o=a.json_to_sheet(n.length?n:[s]),i=a.book_new();a.book_append_sheet(i,o,"Audit"),f(i,`${s.id}_report.xlsx`)},I=()=>{const s=[];c.forEach(i=>{i.capas.length>0?i.capas.forEach(l=>{s.push({AuditID:i.id,Type:i.type,Site:i.site,Auditor:i.auditor,AuditDate:i.date,CAPA_ID:l.id,Description:l.description,Status:l.status,Owner:l.owner})}):s.push({AuditID:i.id,Type:i.type,Site:i.site,Auditor:i.auditor,AuditDate:i.date,CAPA_ID:"",Description:"",Status:"",Owner:""})});const n=a.json_to_sheet(s),o=a.book_new();a.book_append_sheet(o,n,"All_Audits"),f(o,"All_Audit_Report.xlsx")},P=c.filter(s=>s.type==="Internal").length,k=c.filter(s=>s.type==="External").length,_=c.reduce((s,n)=>s+n.totalCapas,0),u=c.reduce((s,n)=>s+n.capas.filter(o=>o.status==="Completed").length,0);return e.jsxs(p,{sx:{p:3},children:[e.jsxs(p,{sx:{background:"linear-gradient(90deg, #9891f8ff, #36368dff)",color:"#fff",borderRadius:2,p:2,mb:3,boxShadow:3},children:[e.jsx(r,{variant:"h5",sx:{fontWeight:"bold"},children:"Audit Master Dashboard"}),e.jsx(r,{variant:"body2",children:"Overview of internal and external audits with CAPA performance"})]}),e.jsxs(b,{direction:{xs:"column",sm:"row"},spacing:2,sx:{mb:3},children:[e.jsxs(x,{sx:{flex:1,p:2,textAlign:"center",background:"linear-gradient(45deg, #e3f2fd, #bbdefb)"},children:[e.jsx(L,{fontSize:"large",color:"primary"}),e.jsx(r,{variant:"subtitle2",children:"Internal Audits"}),e.jsx(r,{variant:"h6",sx:{fontWeight:"bold"},children:P})]}),e.jsxs(x,{sx:{flex:1,p:2,textAlign:"center",background:"linear-gradient(45deg, #e3f2fd, #e398ebff)"},children:[e.jsx(O,{fontSize:"large",sx:{color:"#673ab7"}}),e.jsx(r,{variant:"subtitle2",children:"External Audits"}),e.jsx(r,{variant:"h6",sx:{fontWeight:"bold"},children:k})]}),e.jsxs(x,{sx:{flex:1,p:2,textAlign:"center",background:"linear-gradient(45deg, #e3f2fd, #d3dfa2ff)"},children:[e.jsx(v,{fontSize:"large",color:"success"}),e.jsx(r,{variant:"subtitle2",children:"CAPAs Completed"}),e.jsx(r,{variant:"h6",sx:{fontWeight:"bold"},children:u})]}),e.jsxs(x,{sx:{flex:1,p:2,textAlign:"center",background:"linear-gradient(45deg, #e3f2fd, #c8f6d8ff)"},children:[e.jsx(v,{fontSize:"large",color:"error"}),e.jsx(r,{variant:"subtitle2",children:"Pending CAPAs"}),e.jsx(r,{variant:"h6",sx:{fontWeight:"bold"},children:_-u})]})]}),e.jsxs(x,{children:[e.jsx(T,{title:e.jsxs(b,{direction:"row",alignItems:"center",justifyContent:"space-between",children:[e.jsx(r,{variant:"h6",sx:{fontWeight:"bold"},children:"All Audits Summary"}),e.jsx(w,{variant:"contained",size:"small",sx:{bgcolor:"#7267ef",textTransform:"none"},startIcon:e.jsx(y,{}),onClick:I,children:"Download All Excel"})]})}),e.jsx(H,{children:e.jsxs(A,{children:[e.jsx(g,{sx:{background:"#ede7f6"},children:e.jsxs(d,{children:[e.jsx(t,{}),e.jsx(t,{children:"Audit ID"}),e.jsx(t,{children:"Type"}),e.jsx(t,{children:"Site"}),e.jsx(t,{children:"Auditor"}),e.jsx(t,{children:"Date"}),e.jsx(t,{children:"Non-Compliances"}),e.jsx(t,{children:"CAPAs Completed"}),e.jsx(t,{children:"Total CAPAs"}),e.jsx(t,{children:"Action"})]})}),e.jsx(C,{children:c.map(s=>e.jsxs(R.Fragment,{children:[e.jsxs(d,{children:[e.jsx(t,{children:e.jsx(M,{size:"small",onClick:()=>z(s.id),children:m.includes(s.id)?e.jsx(B,{}):e.jsx(V,{})})}),e.jsx(t,{children:s.id}),e.jsx(t,{children:e.jsx(j,{label:s.type,color:s.type==="Internal"?"primary":"secondary",size:"small"})}),e.jsx(t,{children:s.site}),e.jsx(t,{children:s.auditor}),e.jsx(t,{children:s.date}),e.jsx(t,{children:e.jsx(j,{label:s.nonCompliances,color:s.nonCompliances>0?"error":"success"})}),e.jsx(t,{children:s.capasCompleted}),e.jsx(t,{children:s.totalCapas}),e.jsx(t,{children:e.jsx(w,{size:"small",variant:"outlined",onClick:()=>D(s),children:e.jsx(y,{fontSize:"small"})})})]}),e.jsx(d,{children:e.jsx(t,{colSpan:10,sx:{p:0,border:"none"},children:e.jsx(W,{in:m.includes(s.id),timeout:"auto",children:e.jsxs(p,{sx:{p:2,background:"#fafafa"},children:[e.jsx(r,{variant:"subtitle1",sx:{fontWeight:"bold",mb:1},children:"CAPA Details"}),e.jsxs(A,{size:"small",children:[e.jsx(g,{sx:{background:"#f3e5f5"},children:e.jsxs(d,{children:[e.jsx(t,{children:"CAPA ID"}),e.jsx(t,{children:"Description"}),e.jsx(t,{children:"Status"}),e.jsx(t,{children:"Owner"})]})}),e.jsx(C,{children:s.capas.length>0?s.capas.map(n=>e.jsxs(d,{children:[e.jsx(t,{children:n.id}),e.jsx(t,{children:n.description}),e.jsx(t,{children:e.jsx(j,{label:n.status,color:n.status==="Completed"?"success":"warning",size:"small"})}),e.jsx(t,{children:n.owner})]},n.id)):e.jsx(d,{children:e.jsx(t,{colSpan:4,align:"center",children:"No CAPAs found."})})})]})]})})})})]},s.id))})]})})]})]})};export{ie as default};
