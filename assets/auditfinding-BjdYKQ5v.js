import{j as e,r as d}from"./index-DeCPM1YT.js";import{E}from"./jspdf.es.min-zcs_wkLJ.js";import"./jspdf.plugin.autotable-D1pcuC_d.js";import{f as R,B as V,C as Y,T as N,a as _,b as $,c as y,d as r,e as q}from"./TableRow-Cd9L6edy.js";import{C as G}from"./CardHeader-BFOCdbev.js";import{S as T}from"./Stack-Cb_zqfoO.js";import{B as x}from"./Button-i0LS_vGv.js";import{D as W}from"./Download-CTE8ntCV.js";import{C as J}from"./CardContent-DuW-pjc9.js";import{T as o}from"./TextField-RAEaaxPg.js";import{I as u}from"./InputAdornment-DyuYPr7S.js";import{S as K}from"./Search-C-psGFWq.js";import{I as h}from"./IconButton-oK9S63L7.js";import{E as Q}from"./Edit-DGiN9sfY.js";import{D as X}from"./Delete-PXtfudQB.js";import{D as Z,a as ee,b as te,c as ne}from"./DialogTitle-D5MRwTrG.js";import{C as ie}from"./Close-DenZmEgU.js";import{M as g}from"./MenuItem-BBKtsJ_f.js";import{P as ae}from"./Person-BRpj3OPQ.js";import{a as re}from"./InputLabel-uQorTdpH.js";import{R as oe,a as z}from"./RadioGroup-DZMueATw.js";import{F as P}from"./FormControlLabel-D3Z3CSGr.js";import{C as se}from"./CalendarToday-CE1zo_3e.js";import"./clsx-B-dksMZM.js";import"./ButtonBase-Cikulz_k.js";import"./TransitionGroupContext-CNIvG2Vj.js";import"./Select-B0BFEktc.js";import"./index-DeXogL32.js";import"./Modal-CUDL2x5c.js";import"./Transition-B84HZYJ-.js";import"./dividerClasses-ifTG4Um1.js";import"./isMuiElement-DPWNH1dL.js";import"./SwitchBase-DtxWgrp7.js";import"./FormGroup-SJcGcIPN.js";const L=R(e.jsx("path",{d:"M21.99 4c0-1.1-.89-2-1.99-2H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h14l4 4zM18 14H6v-2h12zm0-3H6V9h12zm0-3H6V6h12z"})),le=R(e.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"})),de=["Non-Conformity","Observation","Improvement"],ue=["Open","Under Review","Closed"],v=[{auditId:"AUD-001",auditorName:"John Smith"},{auditId:"AUD-002",auditorName:"Priya Mehta"},{auditId:"AUD-003",auditorName:"David Lee"}],_e=()=>{const[k,j]=d.useState(!1),[l,A]=d.useState([]),[m,H]=d.useState(""),[c,C]=d.useState(null),[D,f]=d.useState("internal"),[a,p]=d.useState({findingId:"",auditId:"",auditorName:"",findingType:"",findingDescription:"",internalAuditorComments:"",externalAuditorComments:"",responsibleDept:"",targetDate:"",status:"Open"}),F=(t=null)=>{if(t)p(t),C(t.findingId),f(t.auditType||"internal");else{const i=`FND-${(l.length+1).toString().padStart(3,"0")}`;p({findingId:i,auditId:"",auditorName:"",findingType:"",findingDescription:"",internalAuditorComments:"",externalAuditorComments:"",responsibleDept:"",targetDate:"",status:"Open"}),f("internal"),C(null)}j(!0)},I=()=>{j(!1),C(null)},s=t=>{const{name:i,value:n}=t.target;if(p({...a,[i]:n}),i==="auditId"){const w=v.find(b=>b.auditId===n);w&&p(b=>({...b,auditorName:w.auditorName}))}},U=()=>{if(!a.auditId||!a.findingDescription||!a.findingType){alert("Please fill all required fields.");return}const t={...a,auditType:D};A(c?l.map(i=>i.findingId===c?t:i):[...l,t]),I()},B=t=>{window.confirm("Are you sure you want to delete this finding?")&&A(l.filter(i=>i.findingId!==t))},M=t=>{const i=new E;i.setFontSize(14),i.text("Audit Finding Details",105,15,{align:"center"});const n=[["Finding ID",t.findingId],["Audit ID",t.auditId],["Audit Type",t.auditType==="external"?"External":"Internal"],["Auditor Name",t.auditorName],["Finding Type",t.findingType],["Finding Description",t.findingDescription],["Comments",t.auditType==="internal"?t.internalAuditorComments:t.externalAuditorComments],["Responsible Dept",t.responsibleDept],["Target Date",t.targetDate],["Status",t.status]];i.autoTable({startY:25,head:[["Field","Value"]],body:n,theme:"grid",styles:{cellPadding:2,fontSize:11},headStyles:{fillColor:[10,58,110],textColor:255,fontStyle:"bold"}}),i.save(`${t.findingId}.pdf`)},O=()=>{const t=new E;t.setFontSize(14),t.text("All Audit Findings",105,15,{align:"center"});const i=l.map(n=>[n.findingId,n.auditId,n.auditType==="external"?"External":"Internal",n.auditorName,n.findingType,n.findingDescription,n.auditType==="internal"?n.internalAuditorComments:n.externalAuditorComments,n.responsibleDept,n.targetDate,n.status]);t.autoTable({startY:25,head:[["Finding ID","Audit ID","Audit Type","Auditor","Type","Description","Comments","Dept","Target Date","Status"]],body:i,theme:"grid",styles:{cellPadding:2,fontSize:10},headStyles:{fillColor:[10,58,110],textColor:255,fontStyle:"bold"}}),t.save("all_audit_findings.pdf")},S=l.filter(t=>t.findingId.toLowerCase().includes(m.toLowerCase())||t.auditId.toLowerCase().includes(m.toLowerCase())||t.findingType.toLowerCase().includes(m.toLowerCase()));return e.jsxs(V,{sx:{p:3},children:[e.jsxs(Y,{sx:{borderLeft:"6px solid #0A3A6E",borderRadius:2,boxShadow:"0 4px 12px rgba(0,0,0,0.1)"},children:[e.jsx(G,{title:e.jsx(N,{variant:"h6",sx:{fontWeight:"bold",color:"#0A3A6E"},children:"Audit Findings & Comments"}),action:e.jsxs(T,{direction:"row",spacing:1,children:[e.jsx(x,{variant:"contained",sx:{bgcolor:"#0A3A6E"},onClick:()=>F(),children:"+ Add Finding"}),e.jsx(x,{variant:"outlined",sx:{color:"#0A3A6E",borderColor:"#0A3A6E"},startIcon:e.jsx(W,{}),onClick:O,children:"Download All"})]})}),e.jsxs(J,{children:[e.jsx(o,{placeholder:"Search by Finding ID, Audit ID, or Type",fullWidth:!0,value:m,onChange:t=>H(t.target.value),InputProps:{startAdornment:e.jsx(u,{position:"start",children:e.jsx(K,{})})},sx:{mb:2}}),e.jsxs(_,{children:[e.jsx($,{sx:{background:"#E3F2FD"},children:e.jsx(y,{children:["Finding ID","Audit ID","Audit Type","Auditor Name","Type","Description","Comments","Responsible Dept","Target Date","Status","Actions"].map(t=>e.jsx(r,{sx:{fontWeight:"bold",color:"#0A3A6E"},children:t},t))})}),e.jsx(q,{children:S.length>0?S.map(t=>e.jsxs(y,{children:[e.jsx(r,{children:t.findingId}),e.jsx(r,{children:t.auditId}),e.jsx(r,{children:t.auditType==="external"?"External":"Internal"}),e.jsx(r,{children:t.auditorName}),e.jsx(r,{children:t.findingType}),e.jsx(r,{children:t.findingDescription}),e.jsx(r,{children:t.auditType==="internal"?t.internalAuditorComments:t.externalAuditorComments}),e.jsx(r,{children:t.responsibleDept}),e.jsx(r,{children:t.targetDate}),e.jsx(r,{children:e.jsx(N,{sx:{color:t.status==="Closed"?"#2E7D32":t.status==="Under Review"?"#F9A825":"#1E88E5",fontWeight:"bold"},children:t.status})}),e.jsx(r,{children:e.jsxs(T,{direction:"row",spacing:1,children:[e.jsx(h,{size:"small",color:"primary",onClick:()=>F(t),children:e.jsx(Q,{})}),e.jsx(h,{size:"small",color:"error",onClick:()=>B(t.findingId),children:e.jsx(X,{})}),e.jsx(h,{size:"small",color:"secondary",onClick:()=>M(t),children:e.jsx(W,{})})]})})]},t.findingId)):e.jsx(y,{children:e.jsx(r,{colSpan:11,align:"center",children:"No audit findings recorded yet."})})})]})]})]}),e.jsxs(Z,{open:k,onClose:I,fullWidth:!0,maxWidth:"md",children:[e.jsxs(ee,{sx:{bgcolor:"#0A3A6E",color:"#fff",fontWeight:"bold",textAlign:"center",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[c?"Update Audit Finding":"Add New Audit Finding",e.jsx(h,{onClick:()=>j(!1),sx:{color:"#fff"},children:e.jsx(ie,{})})]}),e.jsx(te,{sx:{mt:2,borderRadius:"8px"},children:e.jsxs(T,{spacing:2,sx:{mt:2},children:[e.jsx(o,{label:"Finding ID",name:"findingId",value:a.findingId,fullWidth:!0,disabled:!0}),e.jsx(o,{select:!0,label:"Audit ID (From Audit Planning)",name:"auditId",value:a.auditId,onChange:s,fullWidth:!0,children:v.map(t=>e.jsx(g,{value:t.auditId,children:t.auditId},t.auditId))}),e.jsx(o,{label:"Auditor Name",name:"auditorName",value:a.auditorName,onChange:s,select:!0,fullWidth:!0,InputProps:{startAdornment:e.jsx(u,{position:"start",children:e.jsx(ae,{})})},children:v.map(t=>e.jsx(g,{value:t.auditorName,children:t.auditorName},t.auditorName))}),e.jsx(re,{children:"Audit Type"}),e.jsxs(oe,{row:!0,value:D,onChange:t=>f(t.target.value),children:[e.jsx(P,{value:"internal",control:e.jsx(z,{}),label:"Internal Audit"}),e.jsx(P,{value:"external",control:e.jsx(z,{}),label:"External Audit"})]}),e.jsx(o,{select:!0,label:"Finding Type",name:"findingType",value:a.findingType,onChange:s,fullWidth:!0,children:de.map(t=>e.jsx(g,{value:t,children:t},t))}),e.jsx(o,{label:"Finding Description",name:"findingDescription",value:a.findingDescription,onChange:s,multiline:!0,rows:3,fullWidth:!0,InputProps:{startAdornment:e.jsx(u,{position:"start",children:e.jsx(le,{})})}}),D==="internal"?e.jsx(o,{label:"Internal Auditor Comments",name:"internalAuditorComments",value:a.internalAuditorComments,onChange:s,multiline:!0,rows:2,fullWidth:!0,InputProps:{startAdornment:e.jsx(u,{position:"start",children:e.jsx(L,{})})}}):e.jsx(o,{label:"External Auditor Comments",name:"externalAuditorComments",value:a.externalAuditorComments,onChange:s,multiline:!0,rows:2,fullWidth:!0,InputProps:{startAdornment:e.jsx(u,{position:"start",children:e.jsx(L,{})})}}),e.jsx(o,{label:"Responsible Department",name:"responsibleDept",value:a.responsibleDept,onChange:s,fullWidth:!0}),e.jsx(o,{label:"Target Date",name:"targetDate",type:"date",value:a.targetDate,onChange:s,fullWidth:!0,InputLabelProps:{shrink:!0},InputProps:{startAdornment:e.jsx(u,{position:"start",children:e.jsx(se,{})})}}),e.jsx(o,{select:!0,label:"Status",name:"status",value:a.status,onChange:s,fullWidth:!0,children:ue.map(t=>e.jsx(g,{value:t,children:t},t))})]})}),e.jsxs(ne,{children:[e.jsx(x,{onClick:I,children:"Cancel"}),e.jsx(x,{onClick:U,variant:"contained",sx:{bgcolor:"#0A3A6E"},children:c?"Update Finding":"Save Finding"})]})]})]})};export{_e as default};
