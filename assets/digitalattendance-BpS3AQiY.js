import{r as l,j as e}from"./index-o2L8XDyT.js";import{B as x,C as $,T as d,a as S,b as D,c,d as s,e as E}from"./TableRow-LAUI0Gax.js";import{C as q}from"./CardHeader-D_cDB1rm.js";import{C as G}from"./CardContent-y0pBm6N5.js";import{T as h}from"./TextField-CqNGJcSQ.js";import{I as W,S as w}from"./Search-PceUVjHr.js";import{S as O}from"./Stack-CC4QwJVT.js";import{I as P}from"./IconButton-BsqESdtl.js";import{P as J}from"./Person-DuirIBYZ.js";import{V as Q}from"./Visibility-c_HAbYea.js";import{B as f}from"./Modal-DwRNYzNZ.js";import{D as X}from"./Download-DJ5qoVwr.js";import{D as R,a as F,b as H,c as T}from"./DialogTitle--WyXxo1x.js";import{C as L}from"./Checkbox-B7vmekyc.js";import"./clsx-B-dksMZM.js";import"./ButtonBase-E3CKQj5Y.js";import"./TransitionGroupContext-Dcol0yJe.js";import"./InputLabel-DN3vyk4T.js";import"./Select-BAX3otil.js";import"./index-DMX1Y610.js";import"./Transition-Dl-PhuCn.js";import"./isMuiElement-Dd7xnTXW.js";import"./SwitchBase-BPJm9kF7.js";const N=[{tbtId:"TBT-001",project:"Building A Extension",date:"2025-10-17",topic:"Working at Height",discussionPoints:"Use harness, safety checks",attendees:[{id:"EMP001",name:"Ravi Kumar",designation:"Welder",department:"Fabrication"},{id:"EMP002",name:"Sita Das",designation:"Supervisor",department:"Civil"},{id:"EMP003",name:"Amit Roy",designation:"Electrician",department:"Electrical"}]}];function Ce(){const[o,I]=l.useState(""),[V,v]=l.useState(!1),[B,y]=l.useState(!1),[j,m]=l.useState(""),[p,g]=l.useState({}),[i,u]=l.useState({name:"",date:""}),t=N.find(n=>n.tbtId===o),M=n=>{if(I(n),!p[n]){const a=t.attendees.map(r=>({...r,present:!0,reason:""}));g(r=>({...r,[n]:a}))}u({name:"",date:new Date().toISOString().split("T")[0]}),v(!0)},Y=n=>{I(n),y(!0)},A=()=>{v(!1),m("")},k=()=>{y(!1),m("")},z=n=>{g(a=>({...a,[o]:a[o].map(r=>r.id===n?{...r,present:!r.present}:r)}))},K=(n,a)=>{g(r=>({...r,[o]:r[o].map(C=>C.id===n?{...C,reason:a}:C)}))},b=(p[o]||[]).filter(n=>n.name.toLowerCase().includes(j.toLowerCase())||n.id.toLowerCase().includes(j.toLowerCase())),U=()=>{if(!i.name){alert("Please enter Safety Officer name for sign-off.");return}console.log("Saved Attendance:",p[o]),console.log("Signed-off by:",i),alert(`Attendance saved and signed-off by ${i.name}`),A()};return e.jsxs(x,{sx:{p:3},children:[e.jsxs($,{sx:{borderLeft:"6px solid #0A3A6E",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",borderRadius:2},children:[e.jsx(q,{title:e.jsx(d,{variant:"h6",sx:{color:"#0A3A6E",fontWeight:"bold"},children:"Digital Attendance & Sign-off"})}),e.jsxs(G,{children:[e.jsx(h,{placeholder:"Search Here",fullWidth:!0,value:j,onChange:n=>m(n.target.value),InputProps:{startAdornment:e.jsx(W,{position:"start",children:e.jsx(w,{})})},sx:{mb:2}}),e.jsxs(S,{children:[e.jsx(D,{children:e.jsxs(c,{sx:{background:"#E3F2FD"},children:[e.jsx(s,{sx:{fontWeight:"bold",color:"#0A3A6E"},children:"TBT ID"}),e.jsx(s,{sx:{fontWeight:"bold",color:"#0A3A6E"},children:"Project"}),e.jsx(s,{sx:{fontWeight:"bold",color:"#0A3A6E"},children:"Date"}),e.jsx(s,{sx:{fontWeight:"bold",color:"#0A3A6E"},children:"Topic"}),e.jsx(s,{sx:{fontWeight:"bold",color:"#0A3A6E"},children:"Actions"})]})}),e.jsx(E,{children:N.map(n=>e.jsxs(c,{children:[e.jsx(s,{children:n.tbtId}),e.jsx(s,{children:n.project}),e.jsx(s,{children:n.date}),e.jsx(s,{children:n.topic}),e.jsx(s,{children:e.jsxs(O,{direction:"row",spacing:1,children:[e.jsx(P,{color:"primary",onClick:()=>M(n.tbtId),title:"Mark Attendance",children:e.jsx(J,{})}),e.jsx(P,{color:"secondary",onClick:()=>Y(n.tbtId),title:"View Attendance",children:e.jsx(Q,{})}),e.jsx(f,{sx:{color:"#0A3A6E"},onClick:()=>handleDownload(n.tbtId),children:e.jsx(X,{})})]})})]},n.tbtId))})]})]})]}),e.jsxs(R,{open:V,onClose:A,fullWidth:!0,maxWidth:"md",children:[e.jsxs(F,{sx:{bgcolor:"#0A3A6E",color:"#fff"},children:[t==null?void 0:t.tbtId," - Attendance"]}),e.jsxs(H,{sx:{mt:2},children:[e.jsxs(d,{sx:{mb:2,fontWeight:"bold",color:"#0A3A6E"},children:[t==null?void 0:t.project," | ",t==null?void 0:t.date," | ",t==null?void 0:t.topic]}),e.jsx(h,{placeholder:"Search attendee by name or ID",fullWidth:!0,value:j,onChange:n=>m(n.target.value),InputProps:{startAdornment:e.jsx(W,{position:"start",children:e.jsx(w,{})})},sx:{mb:2}}),e.jsx(x,{sx:{maxHeight:300,overflowY:"auto"},children:e.jsxs(S,{stickyHeader:!0,children:[e.jsx(D,{children:e.jsxs(c,{sx:{background:"#E3F2FD"},children:[e.jsx(s,{children:"Present"}),e.jsx(s,{children:"Employee ID"}),e.jsx(s,{children:"Name"}),e.jsx(s,{children:"Designation"}),e.jsx(s,{children:"Department"}),e.jsx(s,{children:"Reason (if absent)"})]})}),e.jsx(E,{children:b==null?void 0:b.map(n=>e.jsxs(c,{children:[e.jsx(s,{children:e.jsx(L,{checked:n.present,onChange:()=>z(n.id)})}),e.jsx(s,{children:n.id}),e.jsx(s,{children:n.name}),e.jsx(s,{children:n.designation}),e.jsx(s,{children:n.department}),e.jsx(s,{children:!n.present&&e.jsx(h,{value:n.reason,onChange:a=>K(n.id,a.target.value),size:"small"})})]},n.id))})]})}),e.jsxs(x,{sx:{mt:3},children:[e.jsx(d,{sx:{fontWeight:"bold",color:"#0A3A6E",mb:1},children:"Safety Officer Sign-off"}),e.jsxs(O,{direction:"row",spacing:2,children:[e.jsx(h,{label:"Officer Name",fullWidth:!0,value:i.name,onChange:n=>u({...i,name:n.target.value})}),e.jsx(h,{label:"Date",type:"date",fullWidth:!0,InputLabelProps:{shrink:!0},value:i.date,onChange:n=>u({...i,date:n.target.value})})]})]})]}),e.jsxs(T,{children:[e.jsx(f,{onClick:A,color:"error",children:"Cancel"}),e.jsx(f,{onClick:U,variant:"contained",sx:{bgcolor:"#0A3A6E"},children:"Save & Sign-off"})]})]}),e.jsxs(R,{open:B,onClose:k,fullWidth:!0,maxWidth:"md",children:[e.jsxs(F,{sx:{bgcolor:"#0A3A6E",color:"#fff"},children:[t==null?void 0:t.tbtId," - Final Attendance"]}),e.jsxs(H,{sx:{mt:2},children:[e.jsxs(x,{sx:{mb:2,p:1,border:"1px solid #0A3A6E",borderRadius:1},children:[e.jsx(d,{sx:{fontWeight:"bold",color:"#0A3A6E"},children:"Safety Officer Sign-off"}),e.jsxs(d,{children:["Name: ",i.name||"N/A"]}),e.jsxs(d,{children:["Date: ",i.date||"N/A"]})]}),e.jsx(x,{sx:{maxHeight:400,overflowY:"auto"},children:e.jsxs(S,{stickyHeader:!0,children:[e.jsx(D,{children:e.jsxs(c,{sx:{background:"#E3F2FD"},children:[e.jsx(s,{children:"Present"}),e.jsx(s,{children:"Employee ID"}),e.jsx(s,{children:"Name"}),e.jsx(s,{children:"Designation"}),e.jsx(s,{children:"Department"}),e.jsx(s,{children:"Reason (if absent)"})]})}),e.jsx(E,{children:(p[o]||[]).map(n=>e.jsxs(c,{children:[e.jsx(s,{children:e.jsx(L,{checked:n.present,disabled:!0})}),e.jsx(s,{children:n.id}),e.jsx(s,{children:n.name}),e.jsx(s,{children:n.designation}),e.jsx(s,{children:n.department}),e.jsx(s,{children:n.reason})]},n.id))})]})})]}),e.jsx(T,{children:e.jsx(f,{onClick:k,color:"primary",children:"Close"})})]})]})}export{Ce as default};
