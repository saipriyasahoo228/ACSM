function I(e,t,i,n,r){n=n||{};var a=1.15,f=r.internal.scaleFactor,s=r.internal.getFontSize()/f,h=r.getLineHeightFactor?r.getLineHeightFactor():a,o=s*h,l=/\r\n|\r|\n/g,u="",g=1;if((n.valign==="middle"||n.valign==="bottom"||n.halign==="center"||n.halign==="right")&&(u=typeof e=="string"?e.split(l):e,g=u.length||1),i+=s*(2-a),n.valign==="middle"?i-=g/2*o:n.valign==="bottom"&&(i-=g*o),n.halign==="center"||n.halign==="right"){var d=s;if(n.halign==="center"&&(d*=.5),u&&g>=1){for(var p=0;p<u.length;p++)r.text(u[p],t-r.getStringUnitWidth(u[p])*d,i),i+=o;return r}t-=r.getStringUnitWidth(e)*d}return n.halign==="justify"?r.text(e,t,i,{maxWidth:n.maxWidth||100,align:"justify"}):r.text(e,t,i),r}var B={},P=function(){function e(t){this.jsPDFDocument=t,this.userStyles={textColor:t.getTextColor?this.jsPDFDocument.getTextColor():0,fontSize:t.internal.getFontSize(),fontStyle:t.internal.getFont().fontStyle,font:t.internal.getFont().fontName,lineWidth:t.getLineWidth?this.jsPDFDocument.getLineWidth():0,lineColor:t.getDrawColor?this.jsPDFDocument.getDrawColor():0}}return e.setDefaults=function(t,i){i===void 0&&(i=null),i?i.__autoTableDocumentDefaults=t:B=t},e.unifyColor=function(t){return Array.isArray(t)?t:typeof t=="number"?[t,t,t]:typeof t=="string"?[t]:null},e.prototype.applyStyles=function(t,i){var n,r,a;i===void 0&&(i=!1),t.fontStyle&&this.jsPDFDocument.setFontStyle&&this.jsPDFDocument.setFontStyle(t.fontStyle);var f=this.jsPDFDocument.internal.getFont(),s=f.fontStyle,h=f.fontName;if(t.font&&(h=t.font),t.fontStyle){s=t.fontStyle;var o=this.getFontList()[h];o&&o.indexOf(s)===-1&&this.jsPDFDocument.setFontStyle&&(this.jsPDFDocument.setFontStyle(o[0]),s=o[0])}if(this.jsPDFDocument.setFont(h,s),t.fontSize&&this.jsPDFDocument.setFontSize(t.fontSize),!i){var l=e.unifyColor(t.fillColor);l&&(n=this.jsPDFDocument).setFillColor.apply(n,l),l=e.unifyColor(t.textColor),l&&(r=this.jsPDFDocument).setTextColor.apply(r,l),l=e.unifyColor(t.lineColor),l&&(a=this.jsPDFDocument).setDrawColor.apply(a,l),typeof t.lineWidth=="number"&&this.jsPDFDocument.setLineWidth(t.lineWidth)}},e.prototype.splitTextToSize=function(t,i,n){return this.jsPDFDocument.splitTextToSize(t,i,n)},e.prototype.rect=function(t,i,n,r,a){return this.jsPDFDocument.rect(t,i,n,r,a)},e.prototype.getLastAutoTable=function(){return this.jsPDFDocument.lastAutoTable||null},e.prototype.getTextWidth=function(t){return this.jsPDFDocument.getTextWidth(t)},e.prototype.getDocument=function(){return this.jsPDFDocument},e.prototype.setPage=function(t){this.jsPDFDocument.setPage(t)},e.prototype.addPage=function(){return this.jsPDFDocument.addPage()},e.prototype.getFontList=function(){return this.jsPDFDocument.getFontList()},e.prototype.getGlobalOptions=function(){return B||{}},e.prototype.getDocumentOptions=function(){return this.jsPDFDocument.__autoTableDocumentDefaults||{}},e.prototype.pageSize=function(){var t=this.jsPDFDocument.internal.pageSize;return t.width==null&&(t={width:t.getWidth(),height:t.getHeight()}),t},e.prototype.scaleFactor=function(){return this.jsPDFDocument.internal.scaleFactor},e.prototype.getLineHeightFactor=function(){var t=this.jsPDFDocument;return t.getLineHeightFactor?t.getLineHeightFactor():1.15},e.prototype.getLineHeight=function(t){return t/this.scaleFactor()*this.getLineHeightFactor()},e.prototype.pageNumber=function(){var t=this.jsPDFDocument.internal.getCurrentPageInfo();return t?t.pageNumber:this.jsPDFDocument.internal.getNumberOfPages()},e}(),z=function(e,t){return z=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(i[r]=n[r])},z(e,t)};function K(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");z(e,t);function i(){this.constructor=e}e.prototype=t===null?Object.create(t):(i.prototype=t.prototype,new i)}var q=function(e){K(t,e);function t(i){var n=e.call(this)||this;return n._element=i,n}return t}(Array);function et(e){return{font:"helvetica",fontStyle:"normal",overflow:"linebreak",fillColor:!1,textColor:20,halign:"left",valign:"top",fontSize:10,cellPadding:5/e,lineColor:200,lineWidth:0,cellWidth:"auto",minCellHeight:0,minCellWidth:0}}function nt(e){var t={striped:{table:{fillColor:255,textColor:80,fontStyle:"normal"},head:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},body:{},foot:{textColor:255,fillColor:[41,128,185],fontStyle:"bold"},alternateRow:{fillColor:245}},grid:{table:{fillColor:255,textColor:80,fontStyle:"normal",lineWidth:.1},head:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},body:{},foot:{textColor:255,fillColor:[26,188,156],fontStyle:"bold",lineWidth:0},alternateRow:{}},plain:{head:{fontStyle:"bold"},foot:{fontStyle:"bold"}}};return t[e]}function D(e,t,i){i.applyStyles(t,!0);var n=Array.isArray(e)?e:[e],r=n.map(function(a){return i.getTextWidth(a)}).reduce(function(a,f){return Math.max(a,f)},0);return r}function G(e,t,i,n){var r=t.settings.tableLineWidth,a=t.settings.tableLineColor;e.applyStyles({lineWidth:r,lineColor:a});var f=J(r,!1);f&&e.rect(i.x,i.y,t.getWidth(e.pageSize().width),n.y-i.y,f)}function J(e,t){var i=e>0,n=t||t===0;return i&&n?"DF":i?"S":n?"F":null}function F(e,t){var i,n,r,a;if(e=e||t,Array.isArray(e)){if(e.length>=4)return{top:e[0],right:e[1],bottom:e[2],left:e[3]};if(e.length===3)return{top:e[0],right:e[1],bottom:e[2],left:e[1]};if(e.length===2)return{top:e[0],right:e[1],bottom:e[0],left:e[1]};e.length===1?e=e[0]:e=t}return typeof e=="object"?(typeof e.vertical=="number"&&(e.top=e.vertical,e.bottom=e.vertical),typeof e.horizontal=="number"&&(e.right=e.horizontal,e.left=e.horizontal),{left:(i=e.left)!==null&&i!==void 0?i:t,top:(n=e.top)!==null&&n!==void 0?n:t,right:(r=e.right)!==null&&r!==void 0?r:t,bottom:(a=e.bottom)!==null&&a!==void 0?a:t}):(typeof e!="number"&&(e=t),{top:e,right:e,bottom:e,left:e})}function U(e,t){var i=F(t.settings.margin,0);return e.pageSize().width-(i.left+i.right)}function it(e,t,i,n,r){var a={},f=1.3333333333333333,s=b(t,function(c){return r.getComputedStyle(c).backgroundColor});s!=null&&(a.fillColor=s);var h=b(t,function(c){return r.getComputedStyle(c).color});h!=null&&(a.textColor=h);var o=at(n,i);o&&(a.cellPadding=o);var l="borderTopColor",u=f*i,g=n.borderTopWidth;if(n.borderBottomWidth===g&&n.borderRightWidth===g&&n.borderLeftWidth===g){var d=(parseFloat(g)||0)/u;d&&(a.lineWidth=d)}else a.lineWidth={top:(parseFloat(n.borderTopWidth)||0)/u,right:(parseFloat(n.borderRightWidth)||0)/u,bottom:(parseFloat(n.borderBottomWidth)||0)/u,left:(parseFloat(n.borderLeftWidth)||0)/u},a.lineWidth.top||(a.lineWidth.right?l="borderRightColor":a.lineWidth.bottom?l="borderBottomColor":a.lineWidth.left&&(l="borderLeftColor"));var p=b(t,function(c){return r.getComputedStyle(c)[l]});p!=null&&(a.lineColor=p);var m=["left","right","center","justify"];m.indexOf(n.textAlign)!==-1&&(a.halign=n.textAlign),m=["middle","bottom","top"],m.indexOf(n.verticalAlign)!==-1&&(a.valign=n.verticalAlign);var v=parseInt(n.fontSize||"");isNaN(v)||(a.fontSize=v/f);var y=rt(n);y&&(a.fontStyle=y);var x=(n.fontFamily||"").toLowerCase();return e.indexOf(x)!==-1&&(a.font=x),a}function rt(e){var t="";return(e.fontWeight==="bold"||e.fontWeight==="bolder"||parseInt(e.fontWeight)>=700)&&(t="bold"),(e.fontStyle==="italic"||e.fontStyle==="oblique")&&(t+="italic"),t}function b(e,t){var i=_(e,t);if(!i)return null;var n=i.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d*\.?\d*))?\)$/);if(!n||!Array.isArray(n))return null;var r=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])],a=parseInt(n[4]);return a===0||isNaN(r[0])||isNaN(r[1])||isNaN(r[2])?null:r}function _(e,t){var i=t(e);return i==="rgba(0, 0, 0, 0)"||i==="transparent"||i==="initial"||i==="inherit"?e.parentElement==null?null:_(e.parentElement,t):i}function at(e,t){var i=[e.paddingTop,e.paddingRight,e.paddingBottom,e.paddingLeft],n=96/(72/t),r=(parseInt(e.lineHeight)-parseInt(e.fontSize))/t/2,a=i.map(function(s){return parseInt(s||"0")/n}),f=F(a,0);return r>f.top&&(f.top=r),r>f.bottom&&(f.bottom=r),f}function $(e,t,i,n,r){var a,f;n===void 0&&(n=!1),r===void 0&&(r=!1);var s;typeof t=="string"?s=i.document.querySelector(t):s=t;var h=Object.keys(e.getFontList()),o=e.scaleFactor(),l=[],u=[],g=[];if(!s)return console.error("Html table could not be found with input: ",t),{head:l,body:u,foot:g};for(var d=0;d<s.rows.length;d++){var p=s.rows[d],m=(f=(a=p==null?void 0:p.parentElement)===null||a===void 0?void 0:a.tagName)===null||f===void 0?void 0:f.toLowerCase(),v=ot(h,o,i,p,n,r);v&&(m==="thead"?l.push(v):m==="tfoot"?g.push(v):u.push(v))}return{head:l,body:u,foot:g}}function ot(e,t,i,n,r,a){for(var f=new q(n),s=0;s<n.cells.length;s++){var h=n.cells[s],o=i.getComputedStyle(h);if(r||o.display!=="none"){var l=void 0;a&&(l=it(e,h,t,o,i)),f.push({rowSpan:h.rowSpan,colSpan:h.colSpan,styles:l,_element:h,content:ft(h)})}}var u=i.getComputedStyle(n);if(f.length>0&&(r||u.display!=="none"))return f}function ft(e){var t=e.cloneNode(!0);return t.innerHTML=t.innerHTML.replace(/\n/g,"").replace(/ +/g," "),t.innerHTML=t.innerHTML.split(/<br.*?>/).map(function(i){return i.trim()}).join(`
`),t.innerText||t.textContent||""}function st(e,t,i){for(var n=0,r=[e,t,i];n<r.length;n++){var a=r[n];a&&typeof a!="object"&&console.error("The options parameter should be of type object, is: "+typeof a),a.startY&&typeof a.startY!="number"&&(console.error("Invalid value for startY option",a.startY),delete a.startY)}}function w(e,t,i,n,r){if(e==null)throw new TypeError("Cannot convert undefined or null to object");for(var a=Object(e),f=1;f<arguments.length;f++){var s=arguments[f];if(s!=null)for(var h in s)Object.prototype.hasOwnProperty.call(s,h)&&(a[h]=s[h])}return a}function ht(e,t){var i=new P(e),n=i.getDocumentOptions(),r=i.getGlobalOptions();st(r,n,t);var a=w({},r,n,t),f;typeof window<"u"&&(f=window);var s=lt(r,n,t),h=ut(r,n,t),o=gt(i,a),l=pt(i,a,f);return{id:t.tableId,content:l,hooks:h,styles:s,settings:o}}function lt(e,t,i){for(var n={styles:{},headStyles:{},bodyStyles:{},footStyles:{},alternateRowStyles:{},columnStyles:{}},r=function(h){if(h==="columnStyles"){var o=e[h],l=t[h],u=i[h];n.columnStyles=w({},o,l,u)}else{var g=[e,t,i],d=g.map(function(p){return p[h]||{}});n[h]=w({},d[0],d[1],d[2])}},a=0,f=Object.keys(n);a<f.length;a++){var s=f[a];r(s)}return n}function ut(e,t,i){for(var n=[e,t,i],r={didParseCell:[],willDrawCell:[],didDrawCell:[],willDrawPage:[],didDrawPage:[]},a=0,f=n;a<f.length;a++){var s=f[a];s.didParseCell&&r.didParseCell.push(s.didParseCell),s.willDrawCell&&r.willDrawCell.push(s.willDrawCell),s.didDrawCell&&r.didDrawCell.push(s.didDrawCell),s.willDrawPage&&r.willDrawPage.push(s.willDrawPage),s.didDrawPage&&r.didDrawPage.push(s.didDrawPage)}return r}function gt(e,t){var i,n,r,a,f,s,h,o,l,u,g,d,p=F(t.margin,40/e.scaleFactor()),m=(i=dt(e,t.startY))!==null&&i!==void 0?i:p.top,v;t.showFoot===!0?v="everyPage":t.showFoot===!1?v="never":v=(n=t.showFoot)!==null&&n!==void 0?n:"everyPage";var y;t.showHead===!0?y="everyPage":t.showHead===!1?y="never":y=(r=t.showHead)!==null&&r!==void 0?r:"everyPage";var x=(a=t.useCss)!==null&&a!==void 0?a:!1,c=t.theme||(x?"plain":"striped"),C=!!t.horizontalPageBreak,tt=(f=t.horizontalPageBreakRepeat)!==null&&f!==void 0?f:null;return{includeHiddenHtml:(s=t.includeHiddenHtml)!==null&&s!==void 0?s:!1,useCss:x,theme:c,startY:m,margin:p,pageBreak:(h=t.pageBreak)!==null&&h!==void 0?h:"auto",rowPageBreak:(o=t.rowPageBreak)!==null&&o!==void 0?o:"auto",tableWidth:(l=t.tableWidth)!==null&&l!==void 0?l:"auto",showHead:y,showFoot:v,tableLineWidth:(u=t.tableLineWidth)!==null&&u!==void 0?u:0,tableLineColor:(g=t.tableLineColor)!==null&&g!==void 0?g:200,horizontalPageBreak:C,horizontalPageBreakRepeat:tt,horizontalPageBreakBehaviour:(d=t.horizontalPageBreakBehaviour)!==null&&d!==void 0?d:"afterAllRows"}}function dt(e,t){var i=e.getLastAutoTable(),n=e.scaleFactor(),r=e.pageNumber(),a=!1;if(i&&i.startPageNumber){var f=i.startPageNumber+i.pageNumber-1;a=f===r}return typeof t=="number"?t:(t==null||t===!1)&&a&&(i==null?void 0:i.finalY)!=null?i.finalY+20/n:null}function pt(e,t,i){var n=t.head||[],r=t.body||[],a=t.foot||[];if(t.html){var f=t.includeHiddenHtml;if(i){var s=$(e,t.html,i,f,t.useCss)||{};n=s.head||n,r=s.body||n,a=s.foot||n}else console.error("Cannot parse html in non browser environment")}var h=t.columns||vt(n,r,a);return{columns:h,head:n,body:r,foot:a}}function vt(e,t,i){var n=e[0]||t[0]||i[0]||[],r=[];return Object.keys(n).filter(function(a){return a!=="_element"}).forEach(function(a){var f=1,s;Array.isArray(n)?s=n[parseInt(a)]:s=n[a],typeof s=="object"&&!Array.isArray(s)&&(f=(s==null?void 0:s.colSpan)||1);for(var h=0;h<f;h++){var o=void 0;Array.isArray(n)?o=r.length:o=a+(h>0?"_".concat(h):"");var l={dataKey:o};r.push(l)}}),r}var A=function(){function e(t,i,n){this.table=i,this.pageNumber=i.pageNumber,this.settings=i.settings,this.cursor=n,this.doc=t.getDocument()}return e}(),yt=function(e){K(t,e);function t(i,n,r,a,f,s){var h=e.call(this,i,n,s)||this;return h.cell=r,h.row=a,h.column=f,h.section=a.section,h}return t}(A),mt=function(){function e(t,i){this.pageNumber=1,this.id=t.id,this.settings=t.settings,this.styles=t.styles,this.hooks=t.hooks,this.columns=i.columns,this.head=i.head,this.body=i.body,this.foot=i.foot}return e.prototype.getHeadHeight=function(t){return this.head.reduce(function(i,n){return i+n.getMaxCellHeight(t)},0)},e.prototype.getFootHeight=function(t){return this.foot.reduce(function(i,n){return i+n.getMaxCellHeight(t)},0)},e.prototype.allRows=function(){return this.head.concat(this.body).concat(this.foot)},e.prototype.callCellHooks=function(t,i,n,r,a,f){for(var s=0,h=i;s<h.length;s++){var o=h[s],l=new yt(t,this,n,r,a,f),u=o(l)===!1;if(n.text=Array.isArray(n.text)?n.text:[n.text],u)return!1}return!0},e.prototype.callEndPageHooks=function(t,i){t.applyStyles(t.userStyles);for(var n=0,r=this.hooks.didDrawPage;n<r.length;n++){var a=r[n];a(new A(t,this,i))}},e.prototype.callWillDrawPageHooks=function(t,i){for(var n=0,r=this.hooks.willDrawPage;n<r.length;n++){var a=r[n];a(new A(t,this,i))}},e.prototype.getWidth=function(t){if(typeof this.settings.tableWidth=="number")return this.settings.tableWidth;if(this.settings.tableWidth==="wrap"){var i=this.columns.reduce(function(r,a){return r+a.wrappedWidth},0);return i}else{var n=this.settings.margin;return t-n.left-n.right}},e}(),Q=function(){function e(t,i,n,r,a){a===void 0&&(a=!1),this.height=0,this.raw=t,t instanceof q&&(this.raw=t._element,this.element=t._element),this.index=i,this.section=n,this.cells=r,this.spansMultiplePages=a}return e.prototype.getMaxCellHeight=function(t){var i=this;return t.reduce(function(n,r){var a;return Math.max(n,((a=i.cells[r.index])===null||a===void 0?void 0:a.height)||0)},0)},e.prototype.hasRowSpan=function(t){var i=this;return t.filter(function(n){var r=i.cells[n.index];return r?r.rowSpan>1:!1}).length>0},e.prototype.canEntireRowFit=function(t,i){return this.getMaxCellHeight(i)<=t},e.prototype.getMinimumRowHeight=function(t,i){var n=this;return t.reduce(function(r,a){var f=n.cells[a.index];if(!f)return 0;var s=i.getLineHeight(f.styles.fontSize),h=f.padding("vertical"),o=h+s;return o>r?o:r},0)},e}(),X=function(){function e(t,i,n){var r;this.contentHeight=0,this.contentWidth=0,this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.height=0,this.x=0,this.y=0,this.styles=i,this.section=n,this.raw=t;var a=t;t!=null&&typeof t=="object"&&!Array.isArray(t)?(this.rowSpan=t.rowSpan||1,this.colSpan=t.colSpan||1,a=(r=t.content)!==null&&r!==void 0?r:t,t._element&&(this.raw=t._element)):(this.rowSpan=1,this.colSpan=1);var f=a!=null?""+a:"",s=/\r\n|\r|\n/g;this.text=f.split(s)}return e.prototype.getTextPos=function(){var t;if(this.styles.valign==="top")t=this.y+this.padding("top");else if(this.styles.valign==="bottom")t=this.y+this.height-this.padding("bottom");else{var i=this.height-this.padding("vertical");t=this.y+i/2+this.padding("top")}var n;if(this.styles.halign==="right")n=this.x+this.width-this.padding("right");else if(this.styles.halign==="center"){var r=this.width-this.padding("horizontal");n=this.x+r/2+this.padding("left")}else n=this.x+this.padding("left");return{x:n,y:t}},e.prototype.getContentHeight=function(t,i){i===void 0&&(i=1.15);var n=Array.isArray(this.text)?this.text.length:1,r=this.styles.fontSize/t*i,a=n*r+this.padding("vertical");return Math.max(a,this.styles.minCellHeight)},e.prototype.padding=function(t){var i=F(this.styles.cellPadding,0);return t==="vertical"?i.top+i.bottom:t==="horizontal"?i.left+i.right:i[t]},e}(),ct=function(){function e(t,i,n){this.wrappedWidth=0,this.minReadableWidth=0,this.minWidth=0,this.width=0,this.dataKey=t,this.raw=i,this.index=n}return e.prototype.getMaxCustomCellWidth=function(t){for(var i=0,n=0,r=t.allRows();n<r.length;n++){var a=r[n],f=a.cells[this.index];f&&typeof f.styles.cellWidth=="number"&&(i=Math.max(i,f.styles.cellWidth))}return i},e}();function wt(e,t){St(e,t);var i=[],n=0;t.columns.forEach(function(a){var f=a.getMaxCustomCellWidth(t);f?a.width=f:(a.width=a.wrappedWidth,i.push(a)),n+=a.width});var r=t.getWidth(e.pageSize().width)-n;r&&(r=j(i,r,function(a){return Math.max(a.minReadableWidth,a.minWidth)})),r&&(r=j(i,r,function(a){return a.minWidth})),r=Math.abs(r),!t.settings.horizontalPageBreak&&r>.1/e.scaleFactor()&&(r=r<1?r:Math.round(r),console.warn("Of the table content, ".concat(r," units width could not fit page"))),Ct(t),Pt(t,e),xt(t)}function St(e,t){var i=e.scaleFactor(),n=t.settings.horizontalPageBreak,r=U(e,t);t.allRows().forEach(function(a){for(var f=0,s=t.columns;f<s.length;f++){var h=s[f],o=a.cells[h.index];if(o){var l=t.hooks.didParseCell;t.callCellHooks(e,l,o,a,h,null);var u=o.padding("horizontal");o.contentWidth=D(o.text,o.styles,e)+u;var g=D(o.text.join(" ").split(/[^\S\u00A0]+/),o.styles,e);if(o.minReadableWidth=g+o.padding("horizontal"),typeof o.styles.cellWidth=="number")o.minWidth=o.styles.cellWidth,o.wrappedWidth=o.styles.cellWidth;else if(o.styles.cellWidth==="wrap"||n===!0)o.contentWidth>r?(o.minWidth=r,o.wrappedWidth=r):(o.minWidth=o.contentWidth,o.wrappedWidth=o.contentWidth);else{var d=10/i;o.minWidth=o.styles.minCellWidth||d,o.wrappedWidth=o.contentWidth,o.minWidth>o.wrappedWidth&&(o.wrappedWidth=o.minWidth)}}}}),t.allRows().forEach(function(a){for(var f=0,s=t.columns;f<s.length;f++){var h=s[f],o=a.cells[h.index];if(o&&o.colSpan===1)h.wrappedWidth=Math.max(h.wrappedWidth,o.wrappedWidth),h.minWidth=Math.max(h.minWidth,o.minWidth),h.minReadableWidth=Math.max(h.minReadableWidth,o.minReadableWidth);else{var l=t.styles.columnStyles[h.dataKey]||t.styles.columnStyles[h.index]||{},u=l.cellWidth||l.minCellWidth;u&&typeof u=="number"&&(h.minWidth=u,h.wrappedWidth=u)}o&&(o.colSpan>1&&!h.minWidth&&(h.minWidth=o.minWidth),o.colSpan>1&&!h.wrappedWidth&&(h.wrappedWidth=o.minWidth))}})}function j(e,t,i){for(var n=t,r=e.reduce(function(d,p){return d+p.wrappedWidth},0),a=0;a<e.length;a++){var f=e[a],s=f.wrappedWidth/r,h=n*s,o=f.width+h,l=i(f),u=o<l?l:o;t-=u-f.width,f.width=u}if(t=Math.round(t*1e10)/1e10,t){var g=e.filter(function(d){return t<0?d.width>i(d):!0});g.length&&(t=j(g,t,i))}return t}function xt(e){for(var t={},i=1,n=e.allRows(),r=0;r<n.length;r++)for(var a=n[r],f=0,s=e.columns;f<s.length;f++){var h=s[f],o=t[h.index];if(i>1)i--,delete a.cells[h.index];else if(o)o.cell.height+=a.height,i=o.cell.colSpan,delete a.cells[h.index],o.left--,o.left<=1&&delete t[h.index];else{var l=a.cells[h.index];if(!l)continue;if(l.height=a.height,l.rowSpan>1){var u=n.length-r,g=l.rowSpan>u?u:l.rowSpan;t[h.index]={cell:l,left:g,row:a}}}}}function Ct(e){for(var t=e.allRows(),i=0;i<t.length;i++)for(var n=t[i],r=null,a=0,f=0,s=0;s<e.columns.length;s++){var h=e.columns[s];if(f-=1,f>1&&e.columns[s+1])a+=h.width,delete n.cells[h.index];else if(r){var o=r;delete n.cells[h.index],r=null,o.width=h.width+a}else{var o=n.cells[h.index];if(!o)continue;if(f=o.colSpan,a=0,o.colSpan>1){r=o,a+=h.width;continue}o.width=h.width+a}}}function Pt(e,t){for(var i={count:0,height:0},n=0,r=e.allRows();n<r.length;n++){for(var a=r[n],f=0,s=e.columns;f<s.length;f++){var h=s[f],o=a.cells[h.index];if(o){t.applyStyles(o.styles,!0);var l=o.width-o.padding("horizontal");if(o.styles.overflow==="linebreak")o.text=t.splitTextToSize(o.text,l+1/t.scaleFactor(),{fontSize:o.styles.fontSize});else if(o.styles.overflow==="ellipsize")o.text=L(o.text,l,o.styles,t,"...");else if(o.styles.overflow==="hidden")o.text=L(o.text,l,o.styles,t,"");else if(typeof o.styles.overflow=="function"){var u=o.styles.overflow(o.text,l);typeof u=="string"?o.text=[u]:o.text=u}o.contentHeight=o.getContentHeight(t.scaleFactor(),t.getLineHeightFactor());var g=o.contentHeight/o.rowSpan;o.rowSpan>1&&i.count*i.height<g*o.rowSpan?i={height:g,count:o.rowSpan}:i&&i.count>0&&i.height>g&&(g=i.height),g>a.height&&(a.height=g)}}i.count--}}function L(e,t,i,n,r){return e.map(function(a){return Ht(a,t,i,n,r)})}function Ht(e,t,i,n,r){var a=1e4*n.scaleFactor();if(t=Math.ceil(t*a)/a,t>=D(e,i,n))return e;for(;t<D(e+r,i,n)&&!(e.length<=1);)e=e.substring(0,e.length-1);return e.trim()+r}function Dt(e,t){var i=new P(e),n=Wt(t,i.scaleFactor()),r=new mt(t,n);return wt(i,r),i.applyStyles(i.userStyles),r}function Wt(e,t){var i=e.content,n=bt(i.columns);if(i.head.length===0){var r=E(n,"head");r&&i.head.push(r)}if(i.foot.length===0){var r=E(n,"foot");r&&i.foot.push(r)}var a=e.settings.theme,f=e.styles;return{columns:n,head:k("head",i.head,n,f,a,t),body:k("body",i.body,n,f,a,t),foot:k("foot",i.foot,n,f,a,t)}}function k(e,t,i,n,r,a){var f={},s=t.map(function(h,o){for(var l=0,u={},g=0,d=0,p=0,m=i;p<m.length;p++){var v=m[p];if(f[v.index]==null||f[v.index].left===0)if(d===0){var y=void 0;Array.isArray(h)?y=h[v.index-g-l]:y=h[v.dataKey];var x={};typeof y=="object"&&!Array.isArray(y)&&(x=(y==null?void 0:y.styles)||{});var c=kt(e,v,o,r,n,a,x),C=new X(y,c,e);u[v.dataKey]=C,u[v.index]=C,d=C.colSpan-1,f[v.index]={left:C.rowSpan-1,times:d}}else d--,g++;else f[v.index].left--,d=f[v.index].times,l++}return new Q(h,o,e,u)});return s}function E(e,t){var i={};return e.forEach(function(n){if(n.raw!=null){var r=Ft(t,n.raw);r!=null&&(i[n.dataKey]=r)}}),Object.keys(i).length>0?i:null}function Ft(e,t){if(e==="head"){if(typeof t=="object")return t.header||null;if(typeof t=="string"||typeof t=="number")return t}else if(e==="foot"&&typeof t=="object")return t.footer;return null}function bt(e){return e.map(function(t,i){var n,r;return typeof t=="object"?r=(n=t.dataKey)!==null&&n!==void 0?n:i:r=i,new ct(r,t,i)})}function kt(e,t,i,n,r,a,f){var s=nt(n),h;e==="head"?h=r.headStyles:e==="body"?h=r.bodyStyles:e==="foot"&&(h=r.footStyles);var o=w({},s.table,s[e],r.styles,h),l=r.columnStyles[t.dataKey]||r.columnStyles[t.index]||{},u=e==="body"?l:{},g=e==="body"&&i%2===0?w({},s.alternateRow,r.alternateRowStyles):{},d=et(a),p=w({},d,o,g,u);return w(p,f)}function Rt(e,t,i){var n;i===void 0&&(i={});var r=U(e,t),a=new Map,f=[],s=[],h=[];Array.isArray(t.settings.horizontalPageBreakRepeat)?h=t.settings.horizontalPageBreakRepeat:(typeof t.settings.horizontalPageBreakRepeat=="string"||typeof t.settings.horizontalPageBreakRepeat=="number")&&(h=[t.settings.horizontalPageBreakRepeat]),h.forEach(function(g){var d=t.columns.find(function(p){return p.dataKey===g||p.index===g});d&&!a.has(d.index)&&(a.set(d.index,!0),f.push(d.index),s.push(t.columns[d.index]),r-=d.wrappedWidth)});for(var o=!0,l=(n=i==null?void 0:i.start)!==null&&n!==void 0?n:0;l<t.columns.length;){if(a.has(l)){l++;continue}var u=t.columns[l].wrappedWidth;if(o||r>=u)o=!1,f.push(l),s.push(t.columns[l]),r-=u;else break;l++}return{colIndexes:f,columns:s,lastIndex:l-1}}function Tt(e,t){for(var i=[],n=0;n<t.columns.length;n++){var r=Rt(e,t,{start:n});r.columns.length&&(i.push(r),n=r.lastIndex)}return i}function zt(e,t){var i=t.settings,n=i.startY,r=i.margin,a={x:r.left,y:n},f=t.getHeadHeight(t.columns)+t.getFootHeight(t.columns),s=n+r.bottom+f;if(i.pageBreak==="avoid"){var h=t.body,o=h.reduce(function(g,d){return g+d.height},0);s+=o}var l=new P(e);(i.pageBreak==="always"||i.startY!=null&&s>l.pageSize().height)&&(V(l),a.y=r.top),t.callWillDrawPageHooks(l,a);var u=w({},a);t.startPageNumber=l.pageNumber(),i.horizontalPageBreak?At(l,t,u,a):(l.applyStyles(l.userStyles),(i.showHead==="firstPage"||i.showHead==="everyPage")&&t.head.forEach(function(g){return S(l,t,g,a,t.columns)}),l.applyStyles(l.userStyles),t.body.forEach(function(g,d){var p=d===t.body.length-1;W(l,t,g,p,u,a,t.columns)}),l.applyStyles(l.userStyles),(i.showFoot==="lastPage"||i.showFoot==="everyPage")&&t.foot.forEach(function(g){return S(l,t,g,a,t.columns)})),G(l,t,u,a),t.callEndPageHooks(l,a),t.finalY=a.y,e.lastAutoTable=t,l.applyStyles(l.userStyles)}function At(e,t,i,n){var r=Tt(e,t),a=t.settings;if(a.horizontalPageBreakBehaviour==="afterAllRows")r.forEach(function(o,l){e.applyStyles(e.userStyles),l>0?H(e,t,i,n,o.columns,!0):M(e,t,n,o.columns),jt(e,t,i,n,o.columns),R(e,t,n,o.columns)});else for(var f=-1,s=r[0],h=function(){var o=f;if(s){e.applyStyles(e.userStyles);var l=s.columns;f>=0?H(e,t,i,n,l,!0):M(e,t,n,l),o=N(e,t,f+1,n,l),R(e,t,n,l)}var u=o-f;r.slice(1).forEach(function(g){e.applyStyles(e.userStyles),H(e,t,i,n,g.columns,!0),N(e,t,f+1,n,g.columns,u),R(e,t,n,g.columns)}),f=o};f<t.body.length-1;)h()}function M(e,t,i,n){var r=t.settings;e.applyStyles(e.userStyles),(r.showHead==="firstPage"||r.showHead==="everyPage")&&t.head.forEach(function(a){return S(e,t,a,i,n)})}function jt(e,t,i,n,r){e.applyStyles(e.userStyles),t.body.forEach(function(a,f){var s=f===t.body.length-1;W(e,t,a,s,i,n,r)})}function N(e,t,i,n,r,a){e.applyStyles(e.userStyles),a=a??t.body.length;var f=Math.min(i+a,t.body.length),s=-1;return t.body.slice(i,f).forEach(function(h,o){var l=i+o===t.body.length-1,u=Z(e,t,l,n);h.canEntireRowFit(u,r)&&(S(e,t,h,n,r),s=i+o)}),s}function R(e,t,i,n){var r=t.settings;e.applyStyles(e.userStyles),(r.showFoot==="lastPage"||r.showFoot==="everyPage")&&t.foot.forEach(function(a){return S(e,t,a,i,n)})}function Bt(e,t,i){var n=i.getLineHeight(e.styles.fontSize),r=e.padding("vertical"),a=Math.floor((t-r)/n);return Math.max(0,a)}function Lt(e,t,i,n){var r={};e.spansMultiplePages=!0,e.height=0;for(var a=0,f=0,s=i.columns;f<s.length;f++){var h=s[f],o=e.cells[h.index];if(o){Array.isArray(o.text)||(o.text=[o.text]);var l=new X(o.raw,o.styles,o.section);l=w(l,o),l.text=[];var u=Bt(o,t,n);o.text.length>u&&(l.text=o.text.splice(u,o.text.length));var g=n.scaleFactor(),d=n.getLineHeightFactor();o.contentHeight=o.getContentHeight(g,d),o.contentHeight>=t&&(o.contentHeight=t,l.styles.minCellHeight-=t),o.contentHeight>e.height&&(e.height=o.contentHeight),l.contentHeight=l.getContentHeight(g,d),l.contentHeight>a&&(a=l.contentHeight),r[h.index]=l}}var p=new Q(e.raw,-1,e.section,r,!0);p.height=a;for(var m=0,v=i.columns;m<v.length;m++){var h=v[m],l=p.cells[h.index];l&&(l.height=p.height);var o=e.cells[h.index];o&&(o.height=e.height)}return p}function Et(e,t,i,n){var r=e.pageSize().height,a=n.settings.margin,f=a.top+a.bottom,s=r-f;t.section==="body"&&(s-=n.getHeadHeight(n.columns)+n.getFootHeight(n.columns));var h=t.getMinimumRowHeight(n.columns,e),o=h<i;if(h>s)return console.error("Will not be able to print row ".concat(t.index," correctly since it's minimum height is larger than page height")),!0;if(!o)return!1;var l=t.hasRowSpan(n.columns),u=t.getMaxCellHeight(n.columns)>s;return u?(l&&console.error("The content of row ".concat(t.index," will not be drawn correctly since drawing rows with a height larger than the page height and has cells with rowspans is not supported.")),!0):!(l||n.settings.rowPageBreak==="avoid")}function W(e,t,i,n,r,a,f){var s=Z(e,t,n,a);if(i.canEntireRowFit(s,f))S(e,t,i,a,f);else if(Et(e,i,s,t)){var h=Lt(i,s,t,e);S(e,t,i,a,f),H(e,t,r,a,f),W(e,t,h,n,r,a,f)}else H(e,t,r,a,f),W(e,t,i,n,r,a,f)}function S(e,t,i,n,r){n.x=t.settings.margin.left;for(var a=0,f=r;a<f.length;a++){var s=f[a],h=i.cells[s.index];if(!h){n.x+=s.width;continue}e.applyStyles(h.styles),h.x=n.x,h.y=n.y;var o=t.callCellHooks(e,t.hooks.willDrawCell,h,i,s,n);if(o===!1){n.x+=s.width;continue}Mt(e,h,n);var l=h.getTextPos();I(h.text,l.x,l.y,{halign:h.styles.halign,valign:h.styles.valign,maxWidth:Math.ceil(h.width-h.padding("left")-h.padding("right"))},e.getDocument()),t.callCellHooks(e,t.hooks.didDrawCell,h,i,s,n),n.x+=s.width}n.y+=i.height}function Mt(e,t,i){var n=t.styles;if(e.getDocument().setFillColor(e.getDocument().getFillColor()),typeof n.lineWidth=="number"){var r=J(n.lineWidth,n.fillColor);r&&e.rect(t.x,i.y,t.width,t.height,r)}else typeof n.lineWidth=="object"&&(n.fillColor&&e.rect(t.x,i.y,t.width,t.height,"F"),Nt(e,t,i,n.lineWidth))}function Nt(e,t,i,n){var r,a,f,s;n.top&&(r=i.x,a=i.y,f=i.x+t.width,s=i.y,n.right&&(f+=.5*n.right),n.left&&(r-=.5*n.left),h(n.top,r,a,f,s)),n.bottom&&(r=i.x,a=i.y+t.height,f=i.x+t.width,s=i.y+t.height,n.right&&(f+=.5*n.right),n.left&&(r-=.5*n.left),h(n.bottom,r,a,f,s)),n.left&&(r=i.x,a=i.y,f=i.x,s=i.y+t.height,n.top&&(a-=.5*n.top),n.bottom&&(s+=.5*n.bottom),h(n.left,r,a,f,s)),n.right&&(r=i.x+t.width,a=i.y,f=i.x+t.width,s=i.y+t.height,n.top&&(a-=.5*n.top),n.bottom&&(s+=.5*n.bottom),h(n.right,r,a,f,s));function h(o,l,u,g,d){e.getDocument().setLineWidth(o),e.getDocument().line(l,u,g,d,"S")}}function Z(e,t,i,n){var r=t.settings.margin.bottom,a=t.settings.showFoot;return(a==="everyPage"||a==="lastPage"&&i)&&(r+=t.getFootHeight(t.columns)),e.pageSize().height-n.y-r}function H(e,t,i,n,r,a){r===void 0&&(r=[]),a===void 0&&(a=!1),e.applyStyles(e.userStyles),t.settings.showFoot==="everyPage"&&!a&&t.foot.forEach(function(s){return S(e,t,s,n,r)}),t.callEndPageHooks(e,n);var f=t.settings.margin;G(e,t,i,n),V(e),t.pageNumber++,n.x=f.left,n.y=f.top,i.y=f.top,t.callWillDrawPageHooks(e,n),t.settings.showHead==="everyPage"&&(t.head.forEach(function(s){return S(e,t,s,n,r)}),e.applyStyles(e.userStyles))}function V(e){var t=e.pageNumber();e.setPage(t+1);var i=e.pageNumber();return i===t?(e.addPage(),!0):!1}function Ot(e){e.API.autoTable=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n=t[0],r=ht(this,n),a=Dt(this,r);return zt(this,a),this},e.API.lastAutoTable=!1,e.API.autoTableText=function(t,i,n,r){I(t,i,n,r,this)},e.API.autoTableSetDefaults=function(t){return P.setDefaults(t,this),this},e.autoTableSetDefaults=function(t,i){P.setDefaults(t,i)},e.API.autoTableHtmlToJson=function(t,i){var n;if(i===void 0&&(i=!1),typeof window>"u")return console.error("Cannot run autoTableHtmlToJson in non browser environment"),null;var r=new P(this),a=$(r,t,window,i,!1),f=a.head,s=a.body,h=((n=f[0])===null||n===void 0?void 0:n.map(function(o){return o.content}))||[];return{columns:h,rows:s,data:s}}}var T;try{if(typeof window<"u"&&window){var O=window,Y=O.jsPDF||((T=O.jspdf)===null||T===void 0?void 0:T.jsPDF);Y&&Ot(Y)}}catch(e){console.error("Could not apply autoTable plugin",e)}
