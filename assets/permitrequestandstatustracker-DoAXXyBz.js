import{r as c,j as e}from"./index-DeCPM1YT.js";import{B as k,C as A,T as m,a as D,b as R,c as p,d as i,e as S}from"./TableRow-Cd9L6edy.js";import{C as w}from"./CardHeader-BFOCdbev.js";import{B as u}from"./Button-i0LS_vGv.js";import{A as I}from"./Add-C6u5IBut.js";import{C as B}from"./CardContent-DuW-pjc9.js";import{C as b}from"./Chip-D7PQ2JTP.js";import{I as h}from"./IconButton-oK9S63L7.js";import{D as q}from"./Delete-PXtfudQB.js";import{E as M}from"./Edit-DGiN9sfY.js";import{D as N,a as G,b as H,c as L}from"./DialogTitle-D5MRwTrG.js";import{C as O}from"./Close-DenZmEgU.js";import{S as x}from"./Stack-Cb_zqfoO.js";import{T as n,F as z}from"./TextField-RAEaaxPg.js";import{M as T}from"./MenuItem-BBKtsJ_f.js";import"./clsx-B-dksMZM.js";import"./ButtonBase-Cikulz_k.js";import"./TransitionGroupContext-CNIvG2Vj.js";import"./Modal-CUDL2x5c.js";import"./Transition-B84HZYJ-.js";import"./InputLabel-uQorTdpH.js";import"./Select-B0BFEktc.js";import"./index-DeXogL32.js";import"./isMuiElement-DPWNH1dL.js";import"./dividerClasses-ifTG4Um1.js";function xe(){const d=[{id:"PTW-001",name:"Hot Work",requiredChecks:["Gas Test","PPE Check"]},{id:"PTW-002",name:"Confined Space",requiredChecks:["Gas Test","Isolation Certificate"]}],y=[{id:"W001",name:"Ravi Kumar",role:"Welder",competencies:["Gas Test","PPE Check"]},{id:"W002",name:"Anita Sharma",role:"Technician",competencies:["PPE Check"]},{id:"W003",name:"Vikas Singh",role:"Maintenance",competencies:["Gas Test","Isolation Certificate"]}],[j,g]=c.useState([]),[v,l]=c.useState(!1),f={permitType:"",location:"",description:"",selectedWorkers:[],remarks:""},[s,a]=c.useState(f),C=c.useMemo(()=>{if(!s.permitType)return[];const r=d.find(t=>t.id===s.permitType);return r?y.map(t=>{const o=r.requiredChecks.every(E=>t.competencies.includes(E));return{...t,eligible:o}}):[]},[s.permitType]),W=()=>{a(f),l(!0)},P=()=>{if(!s.permitType||s.selectedWorkers.length===0){alert("Please select a permit type and at least one eligible worker.");return}const r=d.find(o=>o.id===s.permitType),t={id:`REQ-${Date.now()}`,permitType:r.name,location:s.location,description:s.description,selectedWorkers:s.selectedWorkers,remarks:s.remarks,status:"Pending Approval",date:new Date().toLocaleString()};g(o=>[t,...o]),l(!1)},F=r=>{window.confirm("Delete this permit request?")&&g(t=>t.filter(o=>o.id!==r))};return e.jsxs(k,{sx:{p:3},children:[e.jsxs(A,{sx:{borderLeft:"6px solid #082A52",boxShadow:"0 6px 18px rgba(0,0,0,0.12)",borderRadius:2},children:[e.jsx(w,{title:e.jsx(m,{variant:"h6",sx:{color:"#082A52",fontWeight:600},children:"Permit Request & Issuance Manager"}),action:e.jsx(u,{variant:"contained",startIcon:e.jsx(I,{}),onClick:W,sx:{backgroundColor:"#082A52","&:hover":{backgroundColor:"#061E3B"}},children:"New Permit Request"})}),e.jsxs(B,{children:[e.jsx(m,{variant:"body2",sx:{mb:2,color:"#334155"},children:"Create and manage permit requests, assign eligible workers, and track approval status."}),e.jsxs(D,{children:[e.jsx(R,{children:e.jsxs(p,{sx:{background:"#E3F2FD"},children:[e.jsx(i,{children:"Request ID"}),e.jsx(i,{children:"Permit Type"}),e.jsx(i,{children:"Location"}),e.jsx(i,{children:"Workers"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Actions"})]})}),e.jsxs(S,{children:[j.map(r=>e.jsxs(p,{children:[e.jsx(i,{children:r.id}),e.jsx(i,{children:r.permitType}),e.jsx(i,{children:r.location}),e.jsx(i,{children:r.selectedWorkers.map(t=>e.jsx(b,{label:t,size:"small",sx:{mr:.5,mb:.5}},t))}),e.jsx(i,{children:e.jsx(b,{label:r.status,size:"small",sx:{backgroundColor:r.status==="Pending Approval"?"#FFF4E5":r.status==="Approved"?"#E7F6EC":"#FFECEC",color:r.status==="Pending Approval"?"#F57C00":r.status==="Approved"?"#2E7D32":"#C62828",fontWeight:600}})}),e.jsxs(i,{children:[e.jsx(h,{color:"error",onClick:()=>F(r.id),children:e.jsx(q,{})}),e.jsx(h,{color:"primary",onClick:()=>handleEdit(r.id),children:e.jsx(M,{})})]})]},r.id)),j.length===0&&e.jsx(p,{children:e.jsxs(i,{colSpan:6,align:"center",sx:{py:4},children:["No permit requests yet. Click ",e.jsx("b",{children:"New Permit Request"})," to create one."]})})]})]})]})]}),e.jsxs(N,{open:v,onClose:()=>l(!1),fullWidth:!0,maxWidth:"md",children:[e.jsxs(G,{sx:{backgroundColor:"#0A3A6E",color:"white",fontWeight:600,py:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:["New Permit Request",e.jsx(h,{onClick:()=>l(!1),sx:{color:"#fff"},children:e.jsx(O,{})})]}),e.jsx(H,{dividers:!0,children:e.jsxs(x,{spacing:3,sx:{mt:1},children:[e.jsx(n,{select:!0,label:"Permit Type",value:s.permitType,onChange:r=>a(t=>({...t,permitType:r.target.value})),fullWidth:!0,required:!0,children:d.map(r=>e.jsx(T,{value:r.id,children:r.name},r.id))}),e.jsxs(x,{direction:"row",spacing:2,children:[e.jsx(n,{label:"Location / Area",fullWidth:!0,value:s.location,onChange:r=>a(t=>({...t,location:r.target.value}))}),e.jsx(n,{label:"Description",fullWidth:!0,value:s.description,onChange:r=>a(t=>({...t,description:r.target.value}))})]}),s.permitType&&e.jsxs(k,{children:[e.jsx(n,{select:!0,label:"Select Eligible Workers",fullWidth:!0,SelectProps:{multiple:!0,renderValue:r=>r.join(", ")},value:s.selectedWorkers,onChange:r=>a(t=>({...t,selectedWorkers:r.target.value})),children:C.filter(r=>r.eligible).map(r=>e.jsx(T,{value:r.name,children:e.jsxs(x,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx("input",{type:"checkbox",checked:s.selectedWorkers.includes(r.name),readOnly:!0}),e.jsxs(m,{children:[r.name," (",r.role,")"]})]})},r.id))}),C.filter(r=>r.eligible).length===0&&e.jsx(z,{sx:{color:"error.main"},children:"No eligible workers found for this permit type."})]}),e.jsx(n,{label:"Remarks",fullWidth:!0,multiline:!0,rows:2,value:s.remarks,onChange:r=>a(t=>({...t,remarks:r.target.value}))})]})}),e.jsxs(L,{children:[e.jsx(u,{onClick:()=>l(!1),sx:{color:"#D32F2F"},children:"Cancel"}),e.jsx(u,{variant:"contained",onClick:P,sx:{backgroundColor:"#082A52",color:"#FFFFFF","&:hover":{backgroundColor:"#061E3B"}},children:"Submit Request"})]})]})]})}export{xe as default};
