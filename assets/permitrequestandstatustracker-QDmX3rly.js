import{r as c,j as e}from"./index-78vIXnNX.js";import{B as f,C as A,T as m,a as D,b as R,c as S,d as p,e as i,f as w}from"./TableRow-Bh4s7eKd.js";import{C as I,S as u}from"./Stack-SA5ch7KR.js";import{B as h}from"./Modal-BRuT0w2r.js";import{A as B}from"./Add-B0X4t8Dt.js";import{C}from"./Chip-CV93Yug4.js";import{I as b,D as q}from"./Delete-De6SPuXf.js";import{E as M}from"./Edit-BTYUVQFF.js";import{D as N,a as G,b as H,c as L}from"./DialogTitle-Cr0WkrxD.js";import{T as l,F as O}from"./TextField-D_h3ch71.js";import{M as T}from"./MenuItem-EDr2Hmyh.js";import"./clsx-B-dksMZM.js";import"./Transition-DLvuwqKz.js";import"./InputLabel-D2cET7_l.js";import"./Select-BDRxS8K1.js";import"./index-Cf5oalkp.js";import"./isMuiElement-CcGzOGYR.js";function ae(){const d=[{id:"PTW-001",name:"Hot Work",requiredChecks:["Gas Test","PPE Check"]},{id:"PTW-002",name:"Confined Space",requiredChecks:["Gas Test","Isolation Certificate"]}],y=[{id:"W001",name:"Ravi Kumar",role:"Welder",competencies:["Gas Test","PPE Check"]},{id:"W002",name:"Anita Sharma",role:"Technician",competencies:["PPE Check"]},{id:"W003",name:"Vikas Singh",role:"Maintenance",competencies:["Gas Test","Isolation Certificate"]}],[x,j]=c.useState([]),[v,n]=c.useState(!1),g={permitType:"",location:"",description:"",selectedWorkers:[],remarks:""},[s,a]=c.useState(g),k=c.useMemo(()=>{if(!s.permitType)return[];const r=d.find(t=>t.id===s.permitType);return r?y.map(t=>{const o=r.requiredChecks.every(E=>t.competencies.includes(E));return{...t,eligible:o}}):[]},[s.permitType]),W=()=>{a(g),n(!0)},P=()=>{if(!s.permitType||s.selectedWorkers.length===0){alert("Please select a permit type and at least one eligible worker.");return}const r=d.find(o=>o.id===s.permitType),t={id:`REQ-${Date.now()}`,permitType:r.name,location:s.location,description:s.description,selectedWorkers:s.selectedWorkers,remarks:s.remarks,status:"Pending Approval",date:new Date().toLocaleString()};j(o=>[t,...o]),n(!1)},F=r=>{window.confirm("Delete this permit request?")&&j(t=>t.filter(o=>o.id!==r))};return e.jsxs(f,{sx:{p:3},children:[e.jsxs(A,{sx:{borderLeft:"6px solid #082A52",boxShadow:"0 6px 18px rgba(0,0,0,0.12)",borderRadius:2},children:[e.jsx(I,{title:e.jsx(m,{variant:"h6",sx:{color:"#082A52",fontWeight:600},children:"Permit Request & Issuance Manager"}),action:e.jsx(h,{variant:"contained",startIcon:e.jsx(B,{}),onClick:W,sx:{backgroundColor:"#082A52","&:hover":{backgroundColor:"#061E3B"}},children:"New Permit Request"})}),e.jsxs(D,{children:[e.jsx(m,{variant:"body2",sx:{mb:2,color:"#334155"},children:"Create and manage permit requests, assign eligible workers, and track approval status."}),e.jsxs(R,{children:[e.jsx(S,{children:e.jsxs(p,{sx:{background:"#E3F2FD"},children:[e.jsx(i,{children:"Request ID"}),e.jsx(i,{children:"Permit Type"}),e.jsx(i,{children:"Location"}),e.jsx(i,{children:"Workers"}),e.jsx(i,{children:"Status"}),e.jsx(i,{children:"Actions"})]})}),e.jsxs(w,{children:[x.map(r=>e.jsxs(p,{children:[e.jsx(i,{children:r.id}),e.jsx(i,{children:r.permitType}),e.jsx(i,{children:r.location}),e.jsx(i,{children:r.selectedWorkers.map(t=>e.jsx(C,{label:t,size:"small",sx:{mr:.5,mb:.5}},t))}),e.jsx(i,{children:e.jsx(C,{label:r.status,size:"small",sx:{backgroundColor:r.status==="Pending Approval"?"#FFF4E5":r.status==="Approved"?"#E7F6EC":"#FFECEC",color:r.status==="Pending Approval"?"#F57C00":r.status==="Approved"?"#2E7D32":"#C62828",fontWeight:600}})}),e.jsxs(i,{children:[e.jsx(b,{color:"error",onClick:()=>F(r.id),children:e.jsx(q,{})}),e.jsx(b,{color:"primary",onClick:()=>handleEdit(r.id),children:e.jsx(M,{})})]})]},r.id)),x.length===0&&e.jsx(p,{children:e.jsxs(i,{colSpan:6,align:"center",sx:{py:4},children:["No permit requests yet. Click ",e.jsx("b",{children:"New Permit Request"})," to create one."]})})]})]})]})]}),e.jsxs(N,{open:v,onClose:()=>n(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(G,{sx:{backgroundColor:"#0A3A6E",color:"white",fontWeight:600,py:3},children:"New Permit Request"}),e.jsx(H,{dividers:!0,children:e.jsxs(u,{spacing:3,sx:{mt:1},children:[e.jsx(l,{select:!0,label:"Permit Type",value:s.permitType,onChange:r=>a(t=>({...t,permitType:r.target.value})),fullWidth:!0,required:!0,children:d.map(r=>e.jsx(T,{value:r.id,children:r.name},r.id))}),e.jsxs(u,{direction:"row",spacing:2,children:[e.jsx(l,{label:"Location / Area",fullWidth:!0,value:s.location,onChange:r=>a(t=>({...t,location:r.target.value}))}),e.jsx(l,{label:"Description",fullWidth:!0,value:s.description,onChange:r=>a(t=>({...t,description:r.target.value}))})]}),s.permitType&&e.jsxs(f,{children:[e.jsx(l,{select:!0,label:"Select Eligible Workers",fullWidth:!0,SelectProps:{multiple:!0,renderValue:r=>r.join(", ")},value:s.selectedWorkers,onChange:r=>a(t=>({...t,selectedWorkers:r.target.value})),children:k.filter(r=>r.eligible).map(r=>e.jsx(T,{value:r.name,children:e.jsxs(u,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx("input",{type:"checkbox",checked:s.selectedWorkers.includes(r.name),readOnly:!0}),e.jsxs(m,{children:[r.name," (",r.role,")"]})]})},r.id))}),k.filter(r=>r.eligible).length===0&&e.jsx(O,{sx:{color:"error.main"},children:"No eligible workers found for this permit type."})]}),e.jsx(l,{label:"Remarks",fullWidth:!0,multiline:!0,rows:2,value:s.remarks,onChange:r=>a(t=>({...t,remarks:r.target.value}))})]})}),e.jsxs(L,{children:[e.jsx(h,{onClick:()=>n(!1),sx:{color:"#D32F2F"},children:"Cancel"}),e.jsx(h,{variant:"contained",onClick:P,sx:{backgroundColor:"#082A52",color:"#FFFFFF","&:hover":{backgroundColor:"#061E3B"}},children:"Submit Request"})]})]})]})}export{ae as default};
