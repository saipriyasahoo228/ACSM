import{j as e,r as w}from"./index-lQRenEQZ.js";import{D as Z,a as G,b as Q,c as ee}from"./DialogTitle-BY4vkXbS.js";import{S as g}from"./Stack-CbGqEpRV.js";import{c as te}from"./clsx-B-dksMZM.js";import{g as se,h as re,f as E,s as R,P as he,i as $,m as N,j as L,u as ie,k as oe,B as H,T as C,C as ae,a as me,b as xe,c as U,d as k,e as ge}from"./TableRow-DOrBXlsl.js";import{u as P}from"./ButtonBase-DbGEVCCx.js";import{C as Ce}from"./Close-DkDoMZWw.js";import{I as O}from"./IconButton-T04wkc8J.js";import{T as A}from"./TextField-DSnqcXEl.js";import{B as T}from"./Modal-B5kKy10H.js";import{D as fe}from"./Divider-CsMF7XuM.js";import{C as ye}from"./CardHeader-CVfYXhzf.js";import{T as V}from"./Tooltip-C8n5BAva.js";import{A as J}from"./Add-Benailh8.js";import{C as ke}from"./CardContent-B105ua6l.js";import{C as W}from"./Chip-Ds2TcdWV.js";import{E as be}from"./Edit-C-2-cLNF.js";import{D as ve}from"./Delete-CGINWn67.js";import{F as je}from"./FormControlLabel-D4MRGypc.js";import{S as we}from"./SwitchBase-D_N6ZnYA.js";import{A as Se,a as Ae,b as Te}from"./AccordionSummary-qKFafVIE.js";import{E as Ie}from"./ExpandMore-CUYkeq_0.js";import"./TransitionGroupContext-Cr6fGhL9.js";import"./InputLabel-D6fBawzD.js";import"./Select-BG3pRAtK.js";import"./index-BGy4LR6Y.js";import"./Transition-CaP-LOaf.js";import"./isMuiElement-CkiPPDrS.js";import"./dividerClasses-HdBjWpbl.js";import"./Popper-C5zl9EtA.js";import"./Collapse-BxTKEx5z.js";function Pe(t){return re("MuiAlert",t)}const X=se("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),$e=E(e.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})),Me=E(e.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"})),qe=E(e.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),Re=E(e.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"})),ze=t=>{const{variant:i,color:l,severity:o,classes:f}=t,d={root:["root",`color${$(l||o)}`,`${i}${$(l||o)}`,`${i}`],icon:["icon"],message:["message"],action:["action"]};return oe(d,Pe,f)},Ee=R(he,{name:"MuiAlert",slot:"Root",overridesResolver:(t,i)=>{const{ownerState:l}=t;return[i.root,i[l.variant],i[`${l.variant}${$(l.color||l.severity)}`]]}})(N(({theme:t})=>{const i=t.palette.mode==="light"?t.darken:t.lighten,l=t.palette.mode==="light"?t.lighten:t.darken;return{...t.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(L(["light"])).map(([o])=>({props:{colorSeverity:o,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${o}Color`]:i(t.palette[o].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${o}StandardBg`]:l(t.palette[o].light,.9),[`& .${X.icon}`]:t.vars?{color:t.vars.palette.Alert[`${o}IconColor`]}:{color:t.palette[o].main}}})),...Object.entries(t.palette).filter(L(["light"])).map(([o])=>({props:{colorSeverity:o,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${o}Color`]:i(t.palette[o].light,.6),border:`1px solid ${(t.vars||t).palette[o].light}`,[`& .${X.icon}`]:t.vars?{color:t.vars.palette.Alert[`${o}IconColor`]}:{color:t.palette[o].main}}})),...Object.entries(t.palette).filter(L(["dark"])).map(([o])=>({props:{colorSeverity:o,variant:"filled"},style:{fontWeight:t.typography.fontWeightMedium,...t.vars?{color:t.vars.palette.Alert[`${o}FilledColor`],backgroundColor:t.vars.palette.Alert[`${o}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[o].dark:t.palette[o].main,color:t.palette.getContrastText(t.palette[o].main)}}}))]}})),Fe=R("div",{name:"MuiAlert",slot:"Icon"})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),Be=R("div",{name:"MuiAlert",slot:"Message"})({padding:"8px 0",minWidth:0,overflow:"auto"}),De=R("div",{name:"MuiAlert",slot:"Action"})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),Y={success:e.jsx($e,{fontSize:"inherit"}),warning:e.jsx(Me,{fontSize:"inherit"}),error:e.jsx(qe,{fontSize:"inherit"}),info:e.jsx(Re,{fontSize:"inherit"})},We=w.forwardRef(function(i,l){const o=ie({props:i,name:"MuiAlert"}),{action:f,children:d,className:x,closeText:u="Close",color:m,components:y={},componentsProps:h={},icon:n,iconMapping:a=Y,onClose:c,role:v="alert",severity:j="success",slotProps:F={},slots:B={},variant:D="standard",...z}=o,S={...o,color:m,severity:j,variant:D,colorSeverity:m||j},M=ze(S),q={slots:{closeButton:y.CloseButton,closeIcon:y.CloseIcon,...B},slotProps:{...h,...F}},[s,r]=P("root",{ref:l,shouldForwardComponentProp:!0,className:te(M.root,x),elementType:Ee,externalForwardedProps:{...q,...z},ownerState:S,additionalProps:{role:v,elevation:0}}),[p,I]=P("icon",{className:M.icon,elementType:Fe,externalForwardedProps:q,ownerState:S}),[ne,le]=P("message",{className:M.message,elementType:Be,externalForwardedProps:q,ownerState:S}),[K,_]=P("action",{className:M.action,elementType:De,externalForwardedProps:q,ownerState:S}),[ce,de]=P("closeButton",{elementType:O,externalForwardedProps:q,ownerState:S}),[ue,pe]=P("closeIcon",{elementType:Ce,externalForwardedProps:q,ownerState:S});return e.jsxs(s,{...r,children:[n!==!1?e.jsx(p,{...I,children:n||a[j]||Y[j]}):null,e.jsx(ne,{...le,children:d}),f!=null?e.jsx(K,{..._,children:f}):null,f==null&&c?e.jsx(K,{..._,children:e.jsx(ce,{size:"small","aria-label":u,title:u,color:"inherit",onClick:c,...de,children:e.jsx(ue,{fontSize:"small",...pe})})}):null]})});function Ne(t){return re("MuiSwitch",t)}const b=se("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),He=t=>{const{classes:i,edge:l,size:o,color:f,checked:d,disabled:x}=t,u={root:["root",l&&`edge${$(l)}`,`size${$(o)}`],switchBase:["switchBase",`color${$(f)}`,d&&"checked",x&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},m=oe(u,Ne,i);return{...i,...m}},Le=R("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(t,i)=>{const{ownerState:l}=t;return[i.root,l.edge&&i[`edge${$(l.edge)}`],i[`size${$(l.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${b.thumb}`]:{width:16,height:16},[`& .${b.switchBase}`]:{padding:4,[`&.${b.checked}`]:{transform:"translateX(16px)"}}}}]}),Oe=R(we,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(t,i)=>{const{ownerState:l}=t;return[i.switchBase,{[`& .${b.input}`]:i.input},l.color!=="default"&&i[`color${$(l.color)}`]]}})(N(({theme:t})=>({position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${t.palette.mode==="light"?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${b.checked}`]:{transform:"translateX(20px)"},[`&.${b.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${b.checked} + .${b.track}`]:{opacity:.5},[`&.${b.disabled} + .${b.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:`${t.palette.mode==="light"?.12:.2}`},[`& .${b.input}`]:{left:"-100%",width:"300%"}})),N(({theme:t})=>({"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter(L(["light"])).map(([i])=>({props:{color:i},style:{[`&.${b.checked}`]:{color:(t.vars||t).palette[i].main,"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[i].main,(t.vars||t).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${b.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${i}DisabledColor`]:`${t.palette.mode==="light"?t.lighten(t.palette[i].main,.62):t.darken(t.palette[i].main,.55)}`}},[`&.${b.checked} + .${b.track}`]:{backgroundColor:(t.vars||t).palette[i].main}}}))]}))),Ue=R("span",{name:"MuiSwitch",slot:"Track"})(N(({theme:t})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${t.palette.mode==="light"?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:`${t.palette.mode==="light"?.38:.3}`}))),Ve=R("span",{name:"MuiSwitch",slot:"Thumb"})(N(({theme:t})=>({boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),Ke=w.forwardRef(function(i,l){const o=ie({props:i,name:"MuiSwitch"}),{className:f,color:d="primary",edge:x=!1,size:u="medium",sx:m,slots:y={},slotProps:h={},...n}=o,a={...o,color:d,edge:x,size:u},c=He(a),v={slots:y,slotProps:h},[j,F]=P("root",{className:te(c.root,f),elementType:Le,externalForwardedProps:v,ownerState:a,additionalProps:{sx:m}}),[B,D]=P("thumb",{className:c.thumb,elementType:Ve,externalForwardedProps:v,ownerState:a}),z=e.jsx(B,{...D}),[S,M]=P("track",{className:c.track,elementType:Ue,externalForwardedProps:v,ownerState:a});return e.jsxs(j,{...F,children:[e.jsx(Oe,{type:"checkbox",icon:z,checkedIcon:z,ref:l,ownerState:a,...n,classes:{...c,root:c.switchBase},slots:{...y.switchBase&&{root:y.switchBase},...y.input&&{input:y.input}},slotProps:{...h.switchBase&&{root:typeof h.switchBase=="function"?h.switchBase(a):h.switchBase},input:{role:"switch"},...h.input&&{input:typeof h.input=="function"?h.input(a):h.input}}}),e.jsx(S,{...M})]})}),_e=E(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11h-4v4h-2v-4H7v-2h4V7h2v4h4z"})),Je=E(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11H7v-2h10z"})),Xe=({open:t,onClose:i,availableChecks:l=[],onChecksUpdate:o,permitTypes:f=[]})=>{const[d,x]=w.useState({key:"",label:"",description:""}),u=l||[],m=f||[],y=()=>{if(!d.key.trim()||!d.label.trim()){alert("Key and Label are required");return}if(u.some(c=>c.key===d.key)){alert("Check with this key already exists");return}const a={key:d.key.trim(),label:d.label.trim(),description:d.description.trim()};o([...u,a]),x({key:"",label:"",description:""})},h=a=>{if(m.some(v=>(v.requiredChecks||[]).includes(a))){alert("Cannot remove check that is currently in use by permit types");return}o(u.filter(v=>v.key!==a))},n=(a,c)=>{if(a!==c.key&&u.some(j=>j.key===c.key)){alert("Check with this key already exists");return}const v=u.map(j=>j.key===a?c:j);o(v)};return e.jsxs(Z,{open:t,onClose:i,fullWidth:!0,maxWidth:"md",children:[e.jsx(G,{children:"Manage Safety Checks"}),e.jsx(Q,{dividers:!0,children:e.jsxs(g,{spacing:3,children:[m.length>0&&e.jsxs(We,{severity:"info",children:[u.filter(a=>m.some(c=>(c.requiredChecks||[]).includes(a.key))).length," checks are currently in use by permit types"]}),e.jsxs(H,{children:[e.jsx(C,{variant:"subtitle2",sx:{mb:2},children:"Add New Check Type"}),e.jsxs(g,{spacing:2,children:[e.jsx(A,{label:"Check Key",value:d.key,onChange:a=>x(c=>({...c,key:a.target.value})),placeholder:"e.g., fireWatch",helperText:"Unique identifier (no spaces, used in backend)",required:!0,fullWidth:!0}),e.jsx(A,{label:"Display Label",value:d.label,onChange:a=>x(c=>({...c,label:a.target.value})),placeholder:"e.g., Fire Watch",helperText:"User-friendly name shown in forms",required:!0,fullWidth:!0}),e.jsx(A,{label:"Description",value:d.description,onChange:a=>x(c=>({...c,description:a.target.value})),placeholder:"e.g., Designated fire watch personnel assigned",multiline:!0,rows:2,fullWidth:!0}),e.jsx(T,{variant:"contained",onClick:y,startIcon:e.jsx(_e,{}),disabled:!d.key.trim()||!d.label.trim(),sx:{alignSelf:"flex-start"},children:"Add Check Type"})]})]}),e.jsx(fe,{}),e.jsxs(H,{children:[e.jsxs(C,{variant:"subtitle2",sx:{mb:2},children:["Available Safety Checks (",u.length,")"]}),e.jsxs(g,{spacing:1,children:[u.map(a=>e.jsx(Ye,{check:a,onUpdate:c=>n(a.key,c),onRemove:()=>h(a.key),isUsed:m.some(c=>(c.requiredChecks||[]).includes(a.key))},a.key)),u.length===0&&e.jsx(C,{variant:"body2",color:"text.secondary",textAlign:"center",sx:{py:3},children:"No safety checks configured. Add your first check above."})]})]})]})}),e.jsx(ee,{children:e.jsx(T,{onClick:i,children:"Close"})})]})},Ye=({check:t,onUpdate:i,onRemove:l,isUsed:o})=>{const[f,d]=w.useState(!1),[x,u]=w.useState(t),m=()=>{if(!x.key.trim()||!x.label.trim()){alert("Key and Label are required");return}i(x),d(!1)},y=()=>{u(t),d(!1)};return e.jsx(ae,{variant:"outlined",sx:{p:2},children:e.jsx(g,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",children:f?e.jsxs(g,{spacing:1,sx:{flex:1},children:[e.jsx(A,{size:"small",value:x.key,onChange:h=>u(n=>({...n,key:h.target.value})),label:"Key",disabled:o}),e.jsx(A,{size:"small",value:x.label,onChange:h=>u(n=>({...n,label:h.target.value})),label:"Label"}),e.jsx(A,{size:"small",value:x.description,onChange:h=>u(n=>({...n,description:h.target.value})),label:"Description",multiline:!0}),e.jsxs(g,{direction:"row",spacing:1,children:[e.jsx(T,{size:"small",variant:"contained",onClick:m,children:"Save"}),e.jsx(T,{size:"small",onClick:y,children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(H,{sx:{flex:1},children:[e.jsxs(g,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(C,{variant:"body1",fontWeight:600,children:t.label}),o&&e.jsx(C,{variant:"caption",color:"primary",sx:{bgcolor:"primary.50",px:1,py:.5,borderRadius:1},children:"In Use"})]}),e.jsxs(C,{variant:"body2",color:"text.secondary",children:["Key: ",t.key]}),t.description&&e.jsx(C,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:t.description})]}),e.jsxs(g,{direction:"row",spacing:.5,children:[e.jsx(T,{size:"small",onClick:()=>d(!0),disabled:o,children:"Edit"}),e.jsx(O,{color:"error",size:"small",onClick:l,disabled:o,children:e.jsx(Je,{})})]})]})})})},Ze=[{key:"gasTest",label:"Gas Test",description:"Atmospheric monitoring for hazardous gases"},{key:"isolationCert",label:"Isolation Certificate",description:"Energy isolation verification"},{key:"ppe",label:"PPE Check",description:"Personal Protective Equipment inspection"},{key:"lockout",label:"LOTO / Isolation",description:"Lockout Tagout procedure completion"}],Ge=[{id:"PTW-001",name:"Hot Work",code:"HOT",description:"Welding, cutting, grinding or any activity producing sparks/heat.",validityHours:8,jsaRequired:!0,requiredChecks:["gasTest","ppe"],customChecklist:["Fire extinguisher available","Hot work permit displayed"]},{id:"PTW-002",name:"Confined Space",code:"CONFINED",description:"Entry into tanks, pits, pits, tunnels requiring permits and monitoring.",validityHours:12,jsaRequired:!0,requiredChecks:["gasTest","isolationCert"],customChecklist:["Atmospheric monitoring logged","Rescue team ready"]}];function Qe(t="PTW"){const i=Date.now().toString(36).slice(-5).toUpperCase();return`${t}-${i}`}function Mt(){const[t,i]=w.useState(Ge),[l,o]=w.useState(Ze),[f,d]=w.useState(!1),[x,u]=w.useState(!1),[m,y]=w.useState(null),h={name:"",code:"",description:"",validityHours:8,jsaRequired:!0,requiredChecks:[],newChecklistItem:"",customChecklist:[]},[n,a]=w.useState(h),c=w.useMemo(()=>{const s={};return l.forEach(r=>s[r.key]=r),s},[l]);function v(){y(null),a(h),d(!0)}function j(s){const r=t.find(p=>p.id===s);r&&(y(s),a({name:r.name,code:r.code,description:r.description,validityHours:r.validityHours,jsaRequired:r.jsaRequired,requiredChecks:r.requiredChecks||[],newChecklistItem:"",customChecklist:r.customChecklist||[]}),d(!0))}function F(s){window.confirm("Delete permit type? This cannot be undone.")&&i(r=>r.filter(p=>p.id!==s))}function B(s){a(r=>{const p=new Set(r.requiredChecks);return p.has(s)?p.delete(s):p.add(s),{...r,requiredChecks:Array.from(p)}})}function D(){var r;const s=(r=n.newChecklistItem)==null?void 0:r.trim();s&&a(p=>({...p,customChecklist:[...p.customChecklist,s],newChecklistItem:""}))}function z(s){a(r=>({...r,customChecklist:r.customChecklist.filter((p,I)=>I!==s)}))}function S(){return n.name.trim()?n.code.trim()?n.validityHours<=0?"Validity hours must be > 0.":null:"Permit code is required.":"Permit name is required."}function M(){const s=S();if(s){alert(s);return}const r={id:m||Qe(),name:n.name.trim(),code:n.code.trim().toUpperCase(),description:n.description.trim(),validityHours:Number(n.validityHours),jsaRequired:!!n.jsaRequired,requiredChecks:n.requiredChecks,customChecklist:n.customChecklist};i(m?p=>p.map(I=>I.id===m?r:I):p=>[r,...p]),d(!1)}const q=()=>e.jsxs(Se,{defaultExpanded:!0,children:[e.jsx(Ae,{expandIcon:e.jsx(Ie,{}),children:e.jsxs(C,{variant:"subtitle2",children:["Required Safety Checks (",n.requiredChecks.length," selected)"]})}),e.jsxs(Te,{children:[e.jsx(C,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Select the mandatory safety checks for this permit type"}),e.jsx(g,{direction:"row",spacing:1,flexWrap:"wrap",children:l.map(s=>{const r=n.requiredChecks.includes(s.key);return e.jsx(V,{title:s.description||s.label,children:e.jsx(W,{label:s.label,clickable:!0,color:r?"primary":"default",variant:r?"filled":"outlined",onClick:()=>B(s.key),sx:{mb:1,bgcolor:r?"rgba(129,212,250,0.25)":void 0,border:r?"1px solid rgba(59,130,246,0.12)":void 0}})},s.key)})}),l.length===0&&e.jsx(C,{variant:"body2",color:"text.secondary",children:'No safety checks available. Add some in the "Manage Checks" section.'})]})]});return e.jsxs(H,{sx:{p:3},children:[e.jsxs(ae,{sx:{borderLeft:"6px solid #082A52",boxShadow:"0 6px 18px rgba(0,0,0,0.12)",borderRadius:2},children:[e.jsx(ye,{title:e.jsx(C,{variant:"h6",sx:{color:"#0E4C92",fontWeight:600},children:"Permit Type Configurator"}),action:e.jsxs(g,{direction:"row",spacing:1,children:[e.jsx(V,{title:"Manage Available Checks",children:e.jsx(T,{variant:"outlined",onClick:()=>u(!0),sx:{mr:1,borderColor:"#81C784",color:"#1B5E20"},children:"Manage Checks"})}),e.jsx(T,{variant:"contained",startIcon:e.jsx(J,{}),onClick:v,sx:{backgroundColor:"#0A3A6E"},children:"New Permit Type"})]})}),e.jsxs(ke,{children:[e.jsx(C,{variant:"body2",sx:{mb:2,color:"#334155"},children:"Define permit categories and their default safety requirements. These are used when creating a new permit request."}),e.jsxs(me,{children:[e.jsx(xe,{children:e.jsxs(U,{sx:{background:"#E3F2FD"},children:[e.jsx(k,{children:"Permit ID"}),e.jsx(k,{children:"Name"}),e.jsx(k,{children:"Code"}),e.jsx(k,{children:"Validity (hrs)"}),e.jsx(k,{children:"JSA"}),e.jsx(k,{children:"Required Checks"}),e.jsx(k,{children:"Actions"})]})}),e.jsxs(ge,{children:[t.map(s=>e.jsxs(U,{children:[e.jsx(k,{children:s.id}),e.jsxs(k,{children:[e.jsx(C,{sx:{fontWeight:600},children:s.name}),e.jsx(C,{variant:"caption",sx:{display:"block",color:"#475569"},children:s.description})]}),e.jsx(k,{children:s.code}),e.jsx(k,{children:s.validityHours}),e.jsx(k,{children:s.jsaRequired?"Yes":"No"}),e.jsx(k,{children:e.jsxs(g,{direction:"row",spacing:.5,flexWrap:"wrap",children:[(s.requiredChecks||[]).map(r=>{var p,I;return e.jsx(V,{title:((p=c[r])==null?void 0:p.description)||r,children:e.jsx(W,{label:((I=c[r])==null?void 0:I.label)||r,size:"small",sx:{mr:.5,mb:.5}})},r)}),(s.customChecklist||[]).slice(0,3).map((r,p)=>e.jsx(W,{label:r,size:"small",variant:"outlined",sx:{mb:.5}},p)),s.customChecklist&&s.customChecklist.length>3&&e.jsx(W,{label:`+${s.customChecklist.length-3} more`,size:"small",sx:{mb:.5}})]})}),e.jsx(k,{children:e.jsxs(g,{direction:"row",spacing:1,children:[e.jsx(O,{color:"primary",onClick:()=>j(s.id),children:e.jsx(be,{})}),e.jsx(O,{color:"error",onClick:()=>F(s.id),children:e.jsx(ve,{})})]})})]},s.id)),t.length===0&&e.jsx(U,{children:e.jsxs(k,{colSpan:7,align:"center",sx:{py:4},children:["No permit types defined yet. Click ",e.jsx("b",{children:"New Permit Type"})," to create one."]})})]})]})]})]}),e.jsxs(Z,{open:f,onClose:()=>d(!1),fullWidth:!0,maxWidth:"md",children:[e.jsx(G,{sx:{backgroundColor:"#0A3A6E",color:"white",fontWeight:600,py:3},children:m?"Edit Permit Type":"New Permit Type"}),e.jsx(Q,{dividers:!0,children:e.jsxs(g,{spacing:2,sx:{pt:1},children:[e.jsxs(g,{direction:{xs:"column",sm:"row"},spacing:2,children:[e.jsx(A,{label:"Permit Name",value:n.name,onChange:s=>a(r=>({...r,name:s.target.value})),fullWidth:!0,required:!0}),e.jsx(A,{label:"Code",value:n.code,onChange:s=>a(r=>({...r,code:s.target.value})),helperText:"Short code (e.g., HOT, CONFINED)",sx:{width:180},required:!0})]}),e.jsx(A,{label:"Description",value:n.description,onChange:s=>a(r=>({...r,description:s.target.value})),fullWidth:!0,multiline:!0,rows:2}),e.jsxs(g,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",children:[e.jsx(A,{label:"Default Validity (hours)",type:"number",value:n.validityHours,onChange:s=>a(r=>({...r,validityHours:Number(s.target.value)})),sx:{width:200},inputProps:{min:1},required:!0}),e.jsx(je,{control:e.jsx(Ke,{checked:n.jsaRequired,onChange:s=>a(r=>({...r,jsaRequired:s.target.checked}))}),label:"JSA Required"})]}),e.jsx(q,{}),e.jsxs(H,{children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1},children:"Custom Checklist Items"}),e.jsxs(g,{direction:"row",spacing:1,alignItems:"center",sx:{mb:1},children:[e.jsx(A,{placeholder:"Add checklist item (e.g., 'Permit board signed')",value:n.newChecklistItem,onChange:s=>a(r=>({...r,newChecklistItem:s.target.value})),fullWidth:!0}),e.jsx(T,{variant:"outlined",onClick:D,startIcon:e.jsx(J,{}),children:"Add"})]}),e.jsxs(g,{direction:"row",spacing:1,flexWrap:"wrap",children:[n.customChecklist.length===0&&e.jsx(C,{variant:"body2",sx:{color:"#64748B"},children:"No custom items yet."}),n.customChecklist.map((s,r)=>e.jsx(W,{label:s,onDelete:()=>z(r),sx:{mb:1}},r))]})]})]})}),e.jsxs(ee,{children:[e.jsx(T,{onClick:()=>d(!1),sx:{color:"#D32F2F",borderColor:"#D32F2F","&:hover":{backgroundColor:"rgba(211, 47, 47, 0.04)",borderColor:"#B71C1C"}},children:"Cancel"}),e.jsx(T,{variant:"contained",onClick:M,sx:{backgroundColor:"#0A3A6E",color:"#FFFFFF","&:hover":{backgroundColor:"#082A52"}},children:m?"Save Changes":"Create Permit Type"})]})]}),e.jsx(Xe,{open:x,onClose:()=>u(!1),availableChecks:l,onChecksUpdate:o,permitTypes:t})]})}export{Mt as default};
