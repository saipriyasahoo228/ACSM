import{j as e,r as w}from"./index-DeCPM1YT.js";import{D as Z,a as G,b as Q,c as ee}from"./DialogTitle-D5MRwTrG.js";import{I as E}from"./IconButton-oK9S63L7.js";import{C as te}from"./Close-DenZmEgU.js";import{S as g}from"./Stack-Cb_zqfoO.js";import{c as se}from"./clsx-B-dksMZM.js";import{h as re,g as ie,f as F,s as R,P as me,j as $,m as H,n as O,u as oe,l as ae,B as L,T as C,C as ne,a as xe,b as ge,c as U,d as k,e as Ce}from"./TableRow-Cd9L6edy.js";import{u as P}from"./ButtonBase-Cikulz_k.js";import{C as fe}from"./Close-BFPS2qWf.js";import{T as A}from"./TextField-RAEaaxPg.js";import{B as T}from"./Button-i0LS_vGv.js";import{D as ye}from"./Divider-DmNs48_-.js";import{C as ke}from"./CardHeader-BFOCdbev.js";import{T as V}from"./Tooltip-yN68D0Y6.js";import{A as J}from"./Add-C6u5IBut.js";import{C as be}from"./CardContent-DuW-pjc9.js";import{C as N}from"./Chip-D7PQ2JTP.js";import{E as je}from"./Edit-DGiN9sfY.js";import{D as ve}from"./Delete-PXtfudQB.js";import{F as we}from"./FormControlLabel-D3Z3CSGr.js";import{S as Se}from"./SwitchBase-DtxWgrp7.js";import{A as Ae,a as Te,b as Ie}from"./AccordionSummary-Vh4ndSVq.js";import{E as Pe}from"./ExpandMore-BjBxeS2K.js";import"./Modal-CUDL2x5c.js";import"./Transition-B84HZYJ-.js";import"./TransitionGroupContext-CNIvG2Vj.js";import"./InputLabel-uQorTdpH.js";import"./Select-B0BFEktc.js";import"./index-DeXogL32.js";import"./isMuiElement-DPWNH1dL.js";import"./dividerClasses-ifTG4Um1.js";import"./Popper-CBRnQHX0.js";import"./Collapse-CI6k5Tak.js";function $e(t){return ie("MuiAlert",t)}const X=re("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]),Me=F(e.jsx("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"})),qe=F(e.jsx("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"})),Re=F(e.jsx("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"})),ze=F(e.jsx("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"})),Ee=t=>{const{variant:i,color:l,severity:o,classes:f}=t,c={root:["root",`color${$(l||o)}`,`${i}${$(l||o)}`,`${i}`],icon:["icon"],message:["message"],action:["action"]};return ae(c,$e,f)},Fe=R(me,{name:"MuiAlert",slot:"Root",overridesResolver:(t,i)=>{const{ownerState:l}=t;return[i.root,i[l.variant],i[`${l.variant}${$(l.color||l.severity)}`]]}})(H(({theme:t})=>{const i=t.palette.mode==="light"?t.darken:t.lighten,l=t.palette.mode==="light"?t.lighten:t.darken;return{...t.typography.body2,backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(t.palette).filter(O(["light"])).map(([o])=>({props:{colorSeverity:o,variant:"standard"},style:{color:t.vars?t.vars.palette.Alert[`${o}Color`]:i(t.palette[o].light,.6),backgroundColor:t.vars?t.vars.palette.Alert[`${o}StandardBg`]:l(t.palette[o].light,.9),[`& .${X.icon}`]:t.vars?{color:t.vars.palette.Alert[`${o}IconColor`]}:{color:t.palette[o].main}}})),...Object.entries(t.palette).filter(O(["light"])).map(([o])=>({props:{colorSeverity:o,variant:"outlined"},style:{color:t.vars?t.vars.palette.Alert[`${o}Color`]:i(t.palette[o].light,.6),border:`1px solid ${(t.vars||t).palette[o].light}`,[`& .${X.icon}`]:t.vars?{color:t.vars.palette.Alert[`${o}IconColor`]}:{color:t.palette[o].main}}})),...Object.entries(t.palette).filter(O(["dark"])).map(([o])=>({props:{colorSeverity:o,variant:"filled"},style:{fontWeight:t.typography.fontWeightMedium,...t.vars?{color:t.vars.palette.Alert[`${o}FilledColor`],backgroundColor:t.vars.palette.Alert[`${o}FilledBg`]}:{backgroundColor:t.palette.mode==="dark"?t.palette[o].dark:t.palette[o].main,color:t.palette.getContrastText(t.palette[o].main)}}}))]}})),Be=R("div",{name:"MuiAlert",slot:"Icon"})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),De=R("div",{name:"MuiAlert",slot:"Message"})({padding:"8px 0",minWidth:0,overflow:"auto"}),We=R("div",{name:"MuiAlert",slot:"Action"})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),Y={success:e.jsx(Me,{fontSize:"inherit"}),warning:e.jsx(qe,{fontSize:"inherit"}),error:e.jsx(Re,{fontSize:"inherit"}),info:e.jsx(ze,{fontSize:"inherit"})},Ne=w.forwardRef(function(i,l){const o=oe({props:i,name:"MuiAlert"}),{action:f,children:c,className:x,closeText:p="Close",color:m,components:y={},componentsProps:h={},icon:n,iconMapping:a=Y,onClose:d,role:j="alert",severity:v="success",slotProps:B={},slots:D={},variant:W="standard",...z}=o,S={...o,color:m,severity:v,variant:W,colorSeverity:m||v},M=Ee(S),q={slots:{closeButton:y.CloseButton,closeIcon:y.CloseIcon,...D},slotProps:{...h,...B}},[s,r]=P("root",{ref:l,shouldForwardComponentProp:!0,className:se(M.root,x),elementType:Fe,externalForwardedProps:{...q,...z},ownerState:S,additionalProps:{role:j,elevation:0}}),[u,I]=P("icon",{className:M.icon,elementType:Be,externalForwardedProps:q,ownerState:S}),[le,ce]=P("message",{className:M.message,elementType:De,externalForwardedProps:q,ownerState:S}),[K,_]=P("action",{className:M.action,elementType:We,externalForwardedProps:q,ownerState:S}),[de,pe]=P("closeButton",{elementType:E,externalForwardedProps:q,ownerState:S}),[ue,he]=P("closeIcon",{elementType:fe,externalForwardedProps:q,ownerState:S});return e.jsxs(s,{...r,children:[n!==!1?e.jsx(u,{...I,children:n||a[v]||Y[v]}):null,e.jsx(le,{...ce,children:c}),f!=null?e.jsx(K,{..._,children:f}):null,f==null&&d?e.jsx(K,{..._,children:e.jsx(de,{size:"small","aria-label":p,title:p,color:"inherit",onClick:d,...pe,children:e.jsx(ue,{fontSize:"small",...he})})}):null]})});function He(t){return ie("MuiSwitch",t)}const b=re("MuiSwitch",["root","edgeStart","edgeEnd","switchBase","colorPrimary","colorSecondary","sizeSmall","sizeMedium","checked","disabled","input","thumb","track"]),Le=t=>{const{classes:i,edge:l,size:o,color:f,checked:c,disabled:x}=t,p={root:["root",l&&`edge${$(l)}`,`size${$(o)}`],switchBase:["switchBase",`color${$(f)}`,c&&"checked",x&&"disabled"],thumb:["thumb"],track:["track"],input:["input"]},m=ae(p,He,i);return{...i,...m}},Oe=R("span",{name:"MuiSwitch",slot:"Root",overridesResolver:(t,i)=>{const{ownerState:l}=t;return[i.root,l.edge&&i[`edge${$(l.edge)}`],i[`size${$(l.size)}`]]}})({display:"inline-flex",width:34+12*2,height:14+12*2,overflow:"hidden",padding:12,boxSizing:"border-box",position:"relative",flexShrink:0,zIndex:0,verticalAlign:"middle","@media print":{colorAdjust:"exact"},variants:[{props:{edge:"start"},style:{marginLeft:-8}},{props:{edge:"end"},style:{marginRight:-8}},{props:{size:"small"},style:{width:40,height:24,padding:7,[`& .${b.thumb}`]:{width:16,height:16},[`& .${b.switchBase}`]:{padding:4,[`&.${b.checked}`]:{transform:"translateX(16px)"}}}}]}),Ue=R(Se,{name:"MuiSwitch",slot:"SwitchBase",overridesResolver:(t,i)=>{const{ownerState:l}=t;return[i.switchBase,{[`& .${b.input}`]:i.input},l.color!=="default"&&i[`color${$(l.color)}`]]}})(H(({theme:t})=>({position:"absolute",top:0,left:0,zIndex:1,color:t.vars?t.vars.palette.Switch.defaultColor:`${t.palette.mode==="light"?t.palette.common.white:t.palette.grey[300]}`,transition:t.transitions.create(["left","transform"],{duration:t.transitions.duration.shortest}),[`&.${b.checked}`]:{transform:"translateX(20px)"},[`&.${b.disabled}`]:{color:t.vars?t.vars.palette.Switch.defaultDisabledColor:`${t.palette.mode==="light"?t.palette.grey[100]:t.palette.grey[600]}`},[`&.${b.checked} + .${b.track}`]:{opacity:.5},[`&.${b.disabled} + .${b.track}`]:{opacity:t.vars?t.vars.opacity.switchTrackDisabled:`${t.palette.mode==="light"?.12:.2}`},[`& .${b.input}`]:{left:"-100%",width:"300%"}})),H(({theme:t})=>({"&:hover":{backgroundColor:t.alpha((t.vars||t).palette.action.active,(t.vars||t).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},variants:[...Object.entries(t.palette).filter(O(["light"])).map(([i])=>({props:{color:i},style:{[`&.${b.checked}`]:{color:(t.vars||t).palette[i].main,"&:hover":{backgroundColor:t.alpha((t.vars||t).palette[i].main,(t.vars||t).palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${b.disabled}`]:{color:t.vars?t.vars.palette.Switch[`${i}DisabledColor`]:`${t.palette.mode==="light"?t.lighten(t.palette[i].main,.62):t.darken(t.palette[i].main,.55)}`}},[`&.${b.checked} + .${b.track}`]:{backgroundColor:(t.vars||t).palette[i].main}}}))]}))),Ve=R("span",{name:"MuiSwitch",slot:"Track"})(H(({theme:t})=>({height:"100%",width:"100%",borderRadius:14/2,zIndex:-1,transition:t.transitions.create(["opacity","background-color"],{duration:t.transitions.duration.shortest}),backgroundColor:t.vars?t.vars.palette.common.onBackground:`${t.palette.mode==="light"?t.palette.common.black:t.palette.common.white}`,opacity:t.vars?t.vars.opacity.switchTrack:`${t.palette.mode==="light"?.38:.3}`}))),Ke=R("span",{name:"MuiSwitch",slot:"Thumb"})(H(({theme:t})=>({boxShadow:(t.vars||t).shadows[1],backgroundColor:"currentColor",width:20,height:20,borderRadius:"50%"}))),_e=w.forwardRef(function(i,l){const o=oe({props:i,name:"MuiSwitch"}),{className:f,color:c="primary",edge:x=!1,size:p="medium",sx:m,slots:y={},slotProps:h={},...n}=o,a={...o,color:c,edge:x,size:p},d=Le(a),j={slots:y,slotProps:h},[v,B]=P("root",{className:se(d.root,f),elementType:Oe,externalForwardedProps:j,ownerState:a,additionalProps:{sx:m}}),[D,W]=P("thumb",{className:d.thumb,elementType:Ke,externalForwardedProps:j,ownerState:a}),z=e.jsx(D,{...W}),[S,M]=P("track",{className:d.track,elementType:Ve,externalForwardedProps:j,ownerState:a});return e.jsxs(v,{...B,children:[e.jsx(Ue,{type:"checkbox",icon:z,checkedIcon:z,ref:l,ownerState:a,...n,classes:{...d,root:d.switchBase},slots:{...y.switchBase&&{root:y.switchBase},...y.input&&{input:y.input}},slotProps:{...h.switchBase&&{root:typeof h.switchBase=="function"?h.switchBase(a):h.switchBase},input:{role:"switch"},...h.input&&{input:typeof h.input=="function"?h.input(a):h.input}}}),e.jsx(S,{...M})]})}),Je=F(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11h-4v4h-2v-4H7v-2h4V7h2v4h4z"})),Xe=F(e.jsx("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m5 11H7v-2h10z"})),Ye=({open:t,onClose:i,availableChecks:l=[],onChecksUpdate:o,permitTypes:f=[]})=>{const[c,x]=w.useState({key:"",label:"",description:""}),p=l||[],m=f||[],y=()=>{if(!c.key.trim()||!c.label.trim()){alert("Key and Label are required");return}if(p.some(d=>d.key===c.key)){alert("Check with this key already exists");return}const a={key:c.key.trim(),label:c.label.trim(),description:c.description.trim()};o([...p,a]),x({key:"",label:"",description:""})},h=a=>{if(m.some(j=>(j.requiredChecks||[]).includes(a))){alert("Cannot remove check that is currently in use by permit types");return}o(p.filter(j=>j.key!==a))},n=(a,d)=>{if(a!==d.key&&p.some(v=>v.key===d.key)){alert("Check with this key already exists");return}const j=p.map(v=>v.key===a?d:v);o(j)};return e.jsxs(Z,{open:t,onClose:i,fullWidth:!0,maxWidth:"md",children:[e.jsxs(G,{sx:{background:"#0E4C92",color:"white",display:"flex",justifyContent:"space-between",alignItems:"center"},children:["Manage Safety Checks",e.jsx(E,{onClick:i,sx:{color:"#fff"},children:e.jsx(te,{})})]}),e.jsx(Q,{dividers:!0,children:e.jsxs(g,{spacing:3,children:[m.length>0&&e.jsxs(Ne,{severity:"info",children:[p.filter(a=>m.some(d=>(d.requiredChecks||[]).includes(a.key))).length," checks are currently in use by permit types"]}),e.jsxs(L,{children:[e.jsx(C,{variant:"subtitle2",sx:{mb:2},children:"Add New Check Type"}),e.jsxs(g,{spacing:2,children:[e.jsx(A,{label:"Check Key",value:c.key,onChange:a=>x(d=>({...d,key:a.target.value})),placeholder:"e.g., fireWatch",helperText:"Unique identifier (no spaces, used in backend)",required:!0,fullWidth:!0}),e.jsx(A,{label:"Display Label",value:c.label,onChange:a=>x(d=>({...d,label:a.target.value})),placeholder:"e.g., Fire Watch",helperText:"User-friendly name shown in forms",required:!0,fullWidth:!0}),e.jsx(A,{label:"Description",value:c.description,onChange:a=>x(d=>({...d,description:a.target.value})),placeholder:"e.g., Designated fire watch personnel assigned",multiline:!0,rows:2,fullWidth:!0}),e.jsx(T,{variant:"contained",onClick:y,startIcon:e.jsx(Je,{}),disabled:!c.key.trim()||!c.label.trim(),sx:{alignSelf:"flex-start"},children:"Add Check Type"})]})]}),e.jsx(ye,{}),e.jsxs(L,{children:[e.jsxs(C,{variant:"subtitle2",sx:{mb:2},children:["Available Safety Checks (",p.length,")"]}),e.jsxs(g,{spacing:1,children:[p.map(a=>e.jsx(Ze,{check:a,onUpdate:d=>n(a.key,d),onRemove:()=>h(a.key),isUsed:m.some(d=>(d.requiredChecks||[]).includes(a.key))},a.key)),p.length===0&&e.jsx(C,{variant:"body2",color:"text.secondary",textAlign:"center",sx:{py:3},children:"No safety checks configured. Add your first check above."})]})]})]})}),e.jsx(ee,{children:e.jsx(T,{onClick:i,children:"Close"})})]})},Ze=({check:t,onUpdate:i,onRemove:l,isUsed:o})=>{const[f,c]=w.useState(!1),[x,p]=w.useState(t),m=()=>{if(!x.key.trim()||!x.label.trim()){alert("Key and Label are required");return}i(x),c(!1)},y=()=>{p(t),c(!1)};return e.jsx(ne,{variant:"outlined",sx:{p:2},children:e.jsx(g,{direction:"row",justifyContent:"space-between",alignItems:"flex-start",children:f?e.jsxs(g,{spacing:1,sx:{flex:1},children:[e.jsx(A,{size:"small",value:x.key,onChange:h=>p(n=>({...n,key:h.target.value})),label:"Key",disabled:o}),e.jsx(A,{size:"small",value:x.label,onChange:h=>p(n=>({...n,label:h.target.value})),label:"Label"}),e.jsx(A,{size:"small",value:x.description,onChange:h=>p(n=>({...n,description:h.target.value})),label:"Description",multiline:!0}),e.jsxs(g,{direction:"row",spacing:1,children:[e.jsx(T,{size:"small",variant:"contained",onClick:m,children:"Save"}),e.jsx(T,{size:"small",onClick:y,children:"Cancel"})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs(L,{sx:{flex:1},children:[e.jsxs(g,{direction:"row",alignItems:"center",spacing:1,children:[e.jsx(C,{variant:"body1",fontWeight:600,children:t.label}),o&&e.jsx(C,{variant:"caption",color:"primary",sx:{bgcolor:"primary.50",px:1,py:.5,borderRadius:1},children:"In Use"})]}),e.jsxs(C,{variant:"body2",color:"text.secondary",children:["Key: ",t.key]}),t.description&&e.jsx(C,{variant:"body2",color:"text.secondary",sx:{mt:.5},children:t.description})]}),e.jsxs(g,{direction:"row",spacing:.5,children:[e.jsx(T,{size:"small",onClick:()=>c(!0),disabled:o,children:"Edit"}),e.jsx(E,{color:"error",size:"small",onClick:l,disabled:o,children:e.jsx(Xe,{})})]})]})})})},Ge=[{key:"gasTest",label:"Gas Test",description:"Atmospheric monitoring for hazardous gases"},{key:"isolationCert",label:"Isolation Certificate",description:"Energy isolation verification"},{key:"ppe",label:"PPE Check",description:"Personal Protective Equipment inspection"},{key:"lockout",label:"LOTO / Isolation",description:"Lockout Tagout procedure completion"}],Qe=[{id:"PTW-001",name:"Hot Work",code:"HOT",description:"Welding, cutting, grinding or any activity producing sparks/heat.",validityHours:8,jsaRequired:!0,requiredChecks:["gasTest","ppe"],customChecklist:["Fire extinguisher available","Hot work permit displayed"]},{id:"PTW-002",name:"Confined Space",code:"CONFINED",description:"Entry into tanks, pits, pits, tunnels requiring permits and monitoring.",validityHours:12,jsaRequired:!0,requiredChecks:["gasTest","isolationCert"],customChecklist:["Atmospheric monitoring logged","Rescue team ready"]}];function et(t="PTW"){const i=Date.now().toString(36).slice(-5).toUpperCase();return`${t}-${i}`}function zt(){const[t,i]=w.useState(Qe),[l,o]=w.useState(Ge),[f,c]=w.useState(!1),[x,p]=w.useState(!1),[m,y]=w.useState(null),h={name:"",code:"",description:"",validityHours:8,jsaRequired:!0,requiredChecks:[],newChecklistItem:"",customChecklist:[]},[n,a]=w.useState(h),d=w.useMemo(()=>{const s={};return l.forEach(r=>s[r.key]=r),s},[l]);function j(){y(null),a(h),c(!0)}function v(s){const r=t.find(u=>u.id===s);r&&(y(s),a({name:r.name,code:r.code,description:r.description,validityHours:r.validityHours,jsaRequired:r.jsaRequired,requiredChecks:r.requiredChecks||[],newChecklistItem:"",customChecklist:r.customChecklist||[]}),c(!0))}function B(s){window.confirm("Delete permit type? This cannot be undone.")&&i(r=>r.filter(u=>u.id!==s))}function D(s){a(r=>{const u=new Set(r.requiredChecks);return u.has(s)?u.delete(s):u.add(s),{...r,requiredChecks:Array.from(u)}})}function W(){var r;const s=(r=n.newChecklistItem)==null?void 0:r.trim();s&&a(u=>({...u,customChecklist:[...u.customChecklist,s],newChecklistItem:""}))}function z(s){a(r=>({...r,customChecklist:r.customChecklist.filter((u,I)=>I!==s)}))}function S(){return n.name.trim()?n.code.trim()?n.validityHours<=0?"Validity hours must be > 0.":null:"Permit code is required.":"Permit name is required."}function M(){const s=S();if(s){alert(s);return}const r={id:m||et(),name:n.name.trim(),code:n.code.trim().toUpperCase(),description:n.description.trim(),validityHours:Number(n.validityHours),jsaRequired:!!n.jsaRequired,requiredChecks:n.requiredChecks,customChecklist:n.customChecklist};i(m?u=>u.map(I=>I.id===m?r:I):u=>[r,...u]),c(!1)}const q=()=>e.jsxs(Ae,{defaultExpanded:!0,children:[e.jsx(Te,{expandIcon:e.jsx(Pe,{}),children:e.jsxs(C,{variant:"subtitle2",children:["Required Safety Checks (",n.requiredChecks.length," selected)"]})}),e.jsxs(Ie,{children:[e.jsx(C,{variant:"body2",color:"text.secondary",sx:{mb:2},children:"Select the mandatory safety checks for this permit type"}),e.jsx(g,{direction:"row",spacing:1,flexWrap:"wrap",children:l.map(s=>{const r=n.requiredChecks.includes(s.key);return e.jsx(V,{title:s.description||s.label,children:e.jsx(N,{label:s.label,clickable:!0,color:r?"primary":"default",variant:r?"filled":"outlined",onClick:()=>D(s.key),sx:{mb:1,bgcolor:r?"rgba(129,212,250,0.25)":void 0,border:r?"1px solid rgba(59,130,246,0.12)":void 0}})},s.key)})}),l.length===0&&e.jsx(C,{variant:"body2",color:"text.secondary",children:'No safety checks available. Add some in the "Manage Checks" section.'})]})]});return e.jsxs(L,{sx:{p:3},children:[e.jsxs(ne,{sx:{borderLeft:"6px solid #082A52",boxShadow:"0 6px 18px rgba(0,0,0,0.12)",borderRadius:2},children:[e.jsx(ke,{title:e.jsx(C,{variant:"h6",sx:{color:"#0E4C92",fontWeight:600},children:"Permit Type Configurator"}),action:e.jsxs(g,{direction:"row",spacing:1,children:[e.jsx(V,{title:"Manage Available Checks",children:e.jsx(T,{variant:"outlined",onClick:()=>p(!0),sx:{mr:1,borderColor:"#81C784",color:"#1B5E20"},children:"Manage Checks"})}),e.jsx(T,{variant:"contained",startIcon:e.jsx(J,{}),onClick:j,sx:{backgroundColor:"#0A3A6E"},children:"New Permit Type"})]})}),e.jsxs(be,{children:[e.jsx(C,{variant:"body2",sx:{mb:2,color:"#334155"},children:"Define permit categories and their default safety requirements. These are used when creating a new permit request."}),e.jsxs(xe,{children:[e.jsx(ge,{children:e.jsxs(U,{sx:{background:"#E3F2FD"},children:[e.jsx(k,{children:"Permit ID"}),e.jsx(k,{children:"Name"}),e.jsx(k,{children:"Code"}),e.jsx(k,{children:"Validity (hrs)"}),e.jsx(k,{children:"JSA"}),e.jsx(k,{children:"Required Checks"}),e.jsx(k,{children:"Actions"})]})}),e.jsxs(Ce,{children:[t.map(s=>e.jsxs(U,{children:[e.jsx(k,{children:s.id}),e.jsxs(k,{children:[e.jsx(C,{sx:{fontWeight:600},children:s.name}),e.jsx(C,{variant:"caption",sx:{display:"block",color:"#475569"},children:s.description})]}),e.jsx(k,{children:s.code}),e.jsx(k,{children:s.validityHours}),e.jsx(k,{children:s.jsaRequired?"Yes":"No"}),e.jsx(k,{children:e.jsxs(g,{direction:"row",spacing:.5,flexWrap:"wrap",children:[(s.requiredChecks||[]).map(r=>{var u,I;return e.jsx(V,{title:((u=d[r])==null?void 0:u.description)||r,children:e.jsx(N,{label:((I=d[r])==null?void 0:I.label)||r,size:"small",sx:{mr:.5,mb:.5}})},r)}),(s.customChecklist||[]).slice(0,3).map((r,u)=>e.jsx(N,{label:r,size:"small",variant:"outlined",sx:{mb:.5}},u)),s.customChecklist&&s.customChecklist.length>3&&e.jsx(N,{label:`+${s.customChecklist.length-3} more`,size:"small",sx:{mb:.5}})]})}),e.jsx(k,{children:e.jsxs(g,{direction:"row",spacing:1,children:[e.jsx(E,{color:"primary",onClick:()=>v(s.id),children:e.jsx(je,{})}),e.jsx(E,{color:"error",onClick:()=>B(s.id),children:e.jsx(ve,{})})]})})]},s.id)),t.length===0&&e.jsx(U,{children:e.jsxs(k,{colSpan:7,align:"center",sx:{py:4},children:["No permit types defined yet. Click ",e.jsx("b",{children:"New Permit Type"})," to create one."]})})]})]})]})]}),e.jsxs(Z,{open:f,onClose:()=>c(!1),fullWidth:!0,maxWidth:"md",children:[e.jsxs(G,{sx:{backgroundColor:"#0A3A6E",color:"white",fontWeight:600,py:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[m?"Edit Permit Type":"New Permit Type",e.jsx(E,{onClick:()=>c(!1),sx:{color:"#fff"},children:e.jsx(te,{})})]}),e.jsx(Q,{dividers:!0,children:e.jsxs(g,{spacing:2,sx:{pt:1},children:[e.jsxs(g,{direction:{xs:"column",sm:"row"},spacing:2,children:[e.jsx(A,{label:"Permit Name",value:n.name,onChange:s=>a(r=>({...r,name:s.target.value})),fullWidth:!0,required:!0}),e.jsx(A,{label:"Code",value:n.code,onChange:s=>a(r=>({...r,code:s.target.value})),helperText:"Short code (e.g., HOT, CONFINED)",sx:{width:180},required:!0})]}),e.jsx(A,{label:"Description",value:n.description,onChange:s=>a(r=>({...r,description:s.target.value})),fullWidth:!0,multiline:!0,rows:2}),e.jsxs(g,{direction:{xs:"column",sm:"row"},spacing:2,alignItems:"center",children:[e.jsx(A,{label:"Default Validity (hours)",type:"number",value:n.validityHours,onChange:s=>a(r=>({...r,validityHours:Number(s.target.value)})),sx:{width:200},inputProps:{min:1},required:!0}),e.jsx(we,{control:e.jsx(_e,{checked:n.jsaRequired,onChange:s=>a(r=>({...r,jsaRequired:s.target.checked}))}),label:"JSA Required"})]}),e.jsx(q,{}),e.jsxs(L,{children:[e.jsx(C,{variant:"subtitle2",sx:{mb:1},children:"Custom Checklist Items"}),e.jsxs(g,{direction:"row",spacing:1,alignItems:"center",sx:{mb:1},children:[e.jsx(A,{placeholder:"Add checklist item (e.g., 'Permit board signed')",value:n.newChecklistItem,onChange:s=>a(r=>({...r,newChecklistItem:s.target.value})),fullWidth:!0}),e.jsx(T,{variant:"outlined",onClick:W,startIcon:e.jsx(J,{}),children:"Add"})]}),e.jsxs(g,{direction:"row",spacing:1,flexWrap:"wrap",children:[n.customChecklist.length===0&&e.jsx(C,{variant:"body2",sx:{color:"#64748B"},children:"No custom items yet."}),n.customChecklist.map((s,r)=>e.jsx(N,{label:s,onDelete:()=>z(r),sx:{mb:1}},r))]})]})]})}),e.jsxs(ee,{children:[e.jsx(T,{onClick:()=>c(!1),sx:{color:"#D32F2F",borderColor:"#D32F2F","&:hover":{backgroundColor:"rgba(211, 47, 47, 0.04)",borderColor:"#B71C1C"}},children:"Cancel"}),e.jsx(T,{variant:"contained",onClick:M,sx:{backgroundColor:"#0A3A6E",color:"#FFFFFF","&:hover":{backgroundColor:"#082A52"}},children:m?"Save Changes":"Create Permit Type"})]})]}),e.jsx(Ye,{open:x,onClose:()=>p(!1),availableChecks:l,onChecksUpdate:o,permitTypes:t})]})}export{zt as default};
