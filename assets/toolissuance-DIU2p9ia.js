import{j as e,r as x}from"./index-o2L8XDyT.js";import{f as R,B as d,C as z,T as n,a as B,b as H,c as f,d as r,e as F,P as G}from"./TableRow-LAUI0Gax.js";import{C as L}from"./CardHeader-D_cDB1rm.js";import{P as _}from"./Person-DuirIBYZ.js";import{B as g}from"./Modal-DwRNYzNZ.js";import{A as $}from"./Add-BlVAoHYJ.js";import{C as N}from"./CardContent-y0pBm6N5.js";import{T as h}from"./TextField-CqNGJcSQ.js";import{I as K,S as Q}from"./Search-PceUVjHr.js";import{S as u}from"./Stack-CC4QwJVT.js";import{C as y}from"./Chip-Cg4wui8B.js";import{I as v}from"./IconButton-BsqESdtl.js";import{E as J}from"./Edit-CN0OCPew.js";import{D as U}from"./Delete-eFAeh1u5.js";import{D as X,a as Y,b as Z,c as V}from"./DialogTitle--WyXxo1x.js";import{A as P}from"./Autocomplete-CQpStQEW.js";import{D as A}from"./Divider-BzhdpjZK.js";import{M as ee}from"./MenuItem-DD5KVmZ_.js";import{C as te}from"./Checkbox-B7vmekyc.js";import"./clsx-B-dksMZM.js";import"./ButtonBase-E3CKQj5Y.js";import"./TransitionGroupContext-Dcol0yJe.js";import"./Transition-Dl-PhuCn.js";import"./InputLabel-DN3vyk4T.js";import"./Select-BAX3otil.js";import"./index-DMX1Y610.js";import"./isMuiElement-Dd7xnTXW.js";import"./Close-Bgr2Wbps.js";import"./Popper-CND6sSKA.js";import"./dividerClasses-AJeEqX5c.js";import"./SwitchBase-BPJm9kF7.js";const se=R(e.jsx("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2m-9 14-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"})),re=R(e.jsx("path",{d:"M19 5v14H5V5zm0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2"})),oe=["PPE","Safety Gear","Tools","Dress"],b=[{id:"PPE-001",name:"Safety Helmet",renewal:12,type:"PPE",category:"Head Protection"},{id:"PPE-002",name:"Acid-Resistant Gloves",renewal:6,type:"PPE",category:"Hand Protection"},{id:"PPE-003",name:"Safety Shoes",renewal:18,type:"PPE",category:"Foot Protection"},{id:"TOOL-001",name:"Tool Kit A",renewal:24,type:"Tools",category:"Electrical"},{id:"TOOL-002",name:"Drill Machine",renewal:12,type:"Tools",category:"Mechanical"},{id:"GEAR-001",name:"Face Shield",renewal:12,type:"Safety Gear",category:"Face Protection"}],E=[{id:"EMP-001",name:"Rajesh Kumar",code:"RK01",department:"Welding"},{id:"EMP-002",name:"Priya Sharma",code:"PS02",department:"Electrical"},{id:"EMP-003",name:"Amit Patel",code:"AP03",department:"Mechanical"}],ae=e.jsx(re,{fontSize:"small"}),ne=e.jsx(se,{fontSize:"small"});function ze(){const[i,j]=x.useState([]),[I,m]=x.useState(!1),[q,k]=x.useState(""),[p,C]=x.useState(null),[o,c]=x.useState({employee_name:"",employee_id:"",department:"",item_type:"",requested_items:[],approval_status:"Pending",request_date:""}),D=()=>{C(null),c({employee_name:"",employee_id:"",department:"",item_type:"",requested_items:[],approval_status:"Pending",request_date:new Date().toISOString().split("T")[0]}),m(!0)},T=t=>{C(t),c(i[t]),m(!0)},O=()=>{if(!o.employee_name||!o.item_type||o.requested_items.length===0){alert("Please select employee, item type, and at least one item");return}const t={...o,request_id:p!==null?o.request_id:`REQ-${i.length+1}`,request_date:new Date().toISOString().split("T")[0]};if(p!==null){const s=[...i];s[p]=t,j(s)}else j([t,...i]);m(!1)},w=t=>{if(window.confirm("Are you sure you want to delete this request?")){const s=[...i];s.splice(t,1),j(s)}},W=t=>{switch(t){case"Approved":return"success";case"Issued":return"info";case"Denied":return"error";case"Pending":return"warning";default:return"default"}},S=b.filter(t=>t.type===o.item_type);return e.jsxs(d,{sx:{p:3},children:[e.jsxs(z,{sx:{borderLeft:"6px solid #0A3A6E",boxShadow:"0 4px 12px rgba(0,0,0,0.1)",borderRadius:2},children:[e.jsx(L,{title:e.jsxs(n,{variant:"h5",sx:{color:"#0A3A6E",fontWeight:600},children:[e.jsx(_,{sx:{mr:1,verticalAlign:"middle"}}),"Contractor Admin - Item Requests"]}),subheader:"Create and manage PPE, Tools, and Safety Gear issuance requests",action:e.jsx(g,{variant:"contained",startIcon:e.jsx($,{}),onClick:D,sx:{backgroundColor:"#0A3A6E",color:"#fff",borderRadius:2,px:3,"&:hover":{backgroundColor:"#082A52"}},children:"New Request"})}),e.jsxs(N,{children:[e.jsx(h,{placeholder:"Search Here",fullWidth:!0,value:q,onChange:t=>k(t.target.value),InputProps:{startAdornment:e.jsx(K,{position:"start",children:e.jsx(Q,{})})},sx:{mb:2}}),e.jsxs(B,{children:[e.jsx(H,{children:e.jsxs(f,{sx:{backgroundColor:"#E3EAFD"},children:[e.jsx(r,{children:"Request ID"}),e.jsx(r,{children:"Employee"}),e.jsx(r,{children:"Department"}),e.jsx(r,{children:"Item Type"}),e.jsx(r,{children:"Requested Items"}),e.jsx(r,{children:"Status"}),e.jsx(r,{children:"Request Date"}),e.jsx(r,{children:"Actions"})]})}),e.jsxs(F,{children:[i.map((t,s)=>e.jsxs(f,{sx:{"&:hover":{backgroundColor:"#f8f9fa"}},children:[e.jsx(r,{children:t.request_id}),e.jsx(r,{children:e.jsxs(d,{children:[e.jsx(n,{sx:{fontWeight:600,fontSize:"0.875rem"},children:t.employee_name}),e.jsx(n,{sx:{color:"text.secondary",fontSize:"0.75rem"},children:t.employee_id})]})}),e.jsx(r,{children:t.department}),e.jsx(r,{children:t.item_type}),e.jsx(r,{children:e.jsx(u,{direction:"row",spacing:.5,flexWrap:"wrap",useFlexGap:!0,children:t.requested_items.map(a=>{const l=b.find(M=>M.id===a);return e.jsx(y,{label:l==null?void 0:l.name,size:"small",sx:{mb:.5}},a)})})}),e.jsx(r,{children:e.jsx(y,{label:t.approval_status,color:W(t.approval_status),size:"small"})}),e.jsx(r,{children:t.request_date}),e.jsx(r,{children:e.jsxs(u,{direction:"row",spacing:.5,children:[t.approval_status==="Pending"&&e.jsx(v,{color:"primary",onClick:()=>T(s),size:"small",title:"Edit Request",children:e.jsx(J,{})}),e.jsx(v,{color:"error",onClick:()=>w(s),size:"small",title:"Delete Request",children:e.jsx(U,{})})]})})]},s)),i.length===0&&e.jsx(f,{children:e.jsx(r,{colSpan:8,align:"center",sx:{py:4},children:e.jsxs(n,{color:"text.secondary",children:["No requests created yet. Click ",e.jsx("b",{children:"New Request"})," to create one."]})})})]})]})]})]}),e.jsxs(X,{open:I,onClose:()=>m(!1),fullWidth:!0,maxWidth:"md",PaperProps:{sx:{borderRadius:3,boxShadow:"0 10px 40px rgba(0,0,0,0.1)"}},children:[e.jsxs(Y,{sx:{backgroundColor:"#0A3A6E",color:"white",fontWeight:600,py:3},children:[e.jsx(_,{sx:{mr:1,verticalAlign:"middle"}}),p!==null?"Edit Item Request":"New Item Request"]}),e.jsx(Z,{sx:{p:4},children:e.jsxs(u,{spacing:4,children:[e.jsxs(d,{children:[e.jsx(n,{variant:"h6",sx:{fontWeight:600,mb:2,color:"#0A3A6E"},children:"Select Employee"}),e.jsx(P,{options:E,getOptionLabel:t=>`${t.name} (${t.code}) - ${t.department}`,value:E.find(t=>t.id===o.employee_id)||null,onChange:(t,s)=>{c(a=>({...a,employee_id:(s==null?void 0:s.id)||"",employee_name:(s==null?void 0:s.name)||"",department:(s==null?void 0:s.department)||""}))},renderInput:t=>e.jsx(h,{...t,placeholder:"Search employee",sx:{"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"#f8f9fa"}}}),isOptionEqualToValue:(t,s)=>t.id===s.id})]}),e.jsx(A,{}),e.jsxs(d,{children:[e.jsx(n,{variant:"h6",sx:{fontWeight:600,mb:2,color:"#0A3A6E"},children:"Select Item Type"}),e.jsx(h,{select:!0,fullWidth:!0,value:o.item_type,onChange:t=>c(s=>({...s,item_type:t.target.value,requested_items:[]})),children:oe.map((t,s)=>e.jsx(ee,{value:t,children:t},s))})]}),e.jsx(A,{}),e.jsxs(d,{children:[e.jsx(n,{variant:"h6",sx:{fontWeight:600,mb:2,color:"#0A3A6E"},children:"Select Items"}),e.jsxs(G,{variant:"outlined",sx:{p:2,borderRadius:2,backgroundColor:"#f8f9fa"},children:[e.jsx(P,{multiple:!0,options:S,disableCloseOnSelect:!0,getOptionLabel:t=>t.name,value:S.filter(t=>o.requested_items.includes(t.id)),onChange:(t,s)=>{c(a=>({...a,requested_items:s.map(l=>l.id)}))},renderOption:(t,s,{selected:a})=>e.jsxs("li",{...t,style:{padding:"12px 16px",borderBottom:"1px solid #e0e0e0"},children:[e.jsx(te,{icon:ae,checkedIcon:ne,style:{marginRight:12},checked:a}),e.jsxs(d,{children:[e.jsx(n,{variant:"body1",fontWeight:500,children:s.name}),e.jsxs(n,{variant:"caption",color:"text.secondary",children:[s.category," â€¢ Renewal: ",s.renewal," months"]})]})]}),renderInput:t=>e.jsx(h,{...t,placeholder:`Choose ${o.item_type||"items"} from list`,sx:{"& .MuiOutlinedInput-root":{borderRadius:2,backgroundColor:"white"}}})}),o.requested_items.length>0&&e.jsxs(d,{sx:{mt:2,p:2,backgroundColor:"white",borderRadius:2},children:[e.jsxs(n,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:["Selected Items (",o.requested_items.length,")"]}),e.jsx(u,{direction:"row",spacing:1,flexWrap:"wrap",useFlexGap:!0,children:o.requested_items.map(t=>{const s=b.find(a=>a.id===t);return e.jsx(y,{label:s==null?void 0:s.name,size:"small",variant:"outlined",onDelete:()=>c(a=>({...a,requested_items:a.requested_items.filter(l=>l!==t)}))},t)})})]})]})]})]})}),e.jsxs(V,{sx:{p:3,gap:2},children:[e.jsx(g,{onClick:()=>m(!1),variant:"outlined",sx:{borderRadius:2,px:4},children:"Cancel"}),e.jsx(g,{variant:"contained",onClick:O,sx:{backgroundColor:"#0A3A6E",borderRadius:2,px:4,fontWeight:600,"&:hover":{backgroundColor:"#082A52"}},children:p!==null?"Save Changes":"Create Request"})]})]})]})}export{ze as default};
