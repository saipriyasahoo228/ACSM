import{r as a,j as e,R}from"./index-DeCPM1YT.js";import{B as E,C as F,T as l,a as B,b as q,c as d,d as i,e as H}from"./TableRow-Cd9L6edy.js";import{C as O}from"./CardHeader-BFOCdbev.js";import{B as j}from"./Button-i0LS_vGv.js";import{A as L}from"./Add-C6u5IBut.js";import{C as N}from"./CardContent-DuW-pjc9.js";import{I as m}from"./IconButton-oK9S63L7.js";import{E as U}from"./ExpandLess-BUkRJSnp.js";import{E as Y}from"./ExpandMore-BjBxeS2K.js";import{S as p}from"./Stack-Cb_zqfoO.js";import{T as _}from"./Tooltip-yN68D0Y6.js";import{C as z}from"./Chip-D7PQ2JTP.js";import{E as G}from"./Edit-DGiN9sfY.js";import{D as K}from"./Delete-PXtfudQB.js";import{C as J}from"./Collapse-CI6k5Tak.js";import{D as Q,a as V,b as X,c as Z}from"./DialogTitle-D5MRwTrG.js";import{C as $}from"./Close-DenZmEgU.js";import{S as ee}from"./Select-B0BFEktc.js";import{M as W}from"./MenuItem-BBKtsJ_f.js";import{F as re}from"./FormGroup-SJcGcIPN.js";import{F as se}from"./FormControlLabel-D3Z3CSGr.js";import{C as oe}from"./Checkbox-B-amFoMf.js";import"./clsx-B-dksMZM.js";import"./ButtonBase-Cikulz_k.js";import"./TransitionGroupContext-CNIvG2Vj.js";import"./index-DeXogL32.js";import"./Popper-CBRnQHX0.js";import"./Modal-CUDL2x5c.js";import"./Transition-B84HZYJ-.js";import"./dividerClasses-ifTG4Um1.js";import"./SwitchBase-DtxWgrp7.js";const ie=[{id:"PTW-001",name:"Hot Work",requiredChecks:["gasTest","ppe"]},{id:"PTW-002",name:"Confined Space",requiredChecks:["gasTest","isolationCert"]},{id:"PTW-003",name:"Work at Height",requiredChecks:["ppe"]},{id:"PTW-004",name:"Electrical Work",requiredChecks:["ppe"]},{id:"PTW-005",name:"Excavation",requiredChecks:["gasTest","isolationCert"]},{id:"PTW-006",name:"Lifting Operations",requiredChecks:["ppe"]}],I=[{id:"W001",name:"John Doe"},{id:"W002",name:"Priya Sahoo"},{id:"W003",name:"Amit Patel"}],y=[{key:"gasTest",label:"Gas Test"},{key:"isolationCert",label:"Isolation Certificate"},{key:"ppe",label:"PPE Check"}];function Be(){const[C,x]=a.useState([]),[T,n]=a.useState(!1),[h,u]=a.useState(null),[f,S]=a.useState({}),[t,c]=a.useState({workerId:"",competencies:[]}),w=()=>{u(null),c({workerId:"",competencies:[]}),n(!0)},A=r=>{u(r.workerId),c({workerId:r.workerId,competencies:r.competencies}),n(!0)},D=r=>{window.confirm("Delete this worker?")&&x(s=>s.filter(o=>o.workerId!==r))},M=r=>{c(s=>{const o=new Set(s.competencies);return o.has(r)?o.delete(r):o.add(r),{...s,competencies:Array.from(o)}})},v=()=>{var s;if(!t.workerId)return alert("Select a Worker");const r={workerId:t.workerId,name:((s=I.find(o=>o.id===t.workerId))==null?void 0:s.name)||"",competencies:t.competencies};x(h?o=>o.map(b=>b.workerId===h?r:b):o=>[...o,r]),n(!1)},g=a.useMemo(()=>{const r={};return y.forEach(s=>r[s.key]=s.label),r},[]),k=(r,s)=>s.requiredChecks.every(o=>r.competencies.includes(o)),P=r=>{S(s=>({...s,[r]:!s[r]}))};return e.jsxs(E,{sx:{p:3},children:[e.jsxs(F,{sx:{borderLeft:"6px solid #082A52",boxShadow:"0 6px 18px rgba(0,0,0,0.12)",borderRadius:2},children:[e.jsx(O,{title:e.jsx(l,{variant:"h6",sx:{color:"#0E4C92",fontWeight:600},children:"Worker & Competency Manager"}),action:e.jsx(j,{variant:"contained",startIcon:e.jsx(L,{}),onClick:w,sx:{backgroundColor:"#0A3A6E"},children:"Assign Competencies"})}),e.jsx(N,{children:e.jsxs(B,{children:[e.jsx(q,{children:e.jsxs(d,{sx:{background:"#E3F2FD"},children:[e.jsx(i,{}),e.jsx(i,{children:"Worker ID"}),e.jsx(i,{children:"Name"}),e.jsx(i,{children:"Competencies"}),e.jsx(i,{align:"center",children:"Actions"})]})}),e.jsxs(H,{children:[C.map(r=>e.jsxs(R.Fragment,{children:[e.jsxs(d,{children:[e.jsx(i,{children:e.jsx(m,{size:"small",onClick:()=>P(r.workerId),children:f[r.workerId]?e.jsx(U,{}):e.jsx(Y,{})})}),e.jsx(i,{children:r.workerId}),e.jsx(i,{children:r.name}),e.jsx(i,{children:e.jsxs(p,{direction:"row",spacing:.5,flexWrap:"wrap",children:[r.competencies.length===0&&e.jsx(l,{variant:"body2",sx:{color:"#64748B"},children:"None"}),r.competencies.map(s=>e.jsx(_,{title:g[s],children:e.jsx(z,{label:g[s],size:"small",sx:{mb:.5}})},s))]})}),e.jsx(i,{align:"center",children:e.jsxs(p,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(m,{color:"primary",onClick:()=>A(r),children:e.jsx(G,{})}),e.jsx(m,{color:"error",onClick:()=>D(r.workerId),children:e.jsx(K,{})})]})})]}),e.jsx(d,{children:e.jsx(i,{style:{paddingBottom:0,paddingTop:0},colSpan:5,children:e.jsx(J,{in:f[r.workerId],timeout:"auto",unmountOnExit:!0,children:e.jsxs(E,{sx:{margin:1},children:[e.jsx(l,{variant:"subtitle2",sx:{mb:1},children:"Permit Eligibility"}),e.jsx(p,{spacing:1,children:ie.map(s=>e.jsxs(l,{sx:{color:k(r,s)?"green":"red",fontWeight:600},children:[s.name,": ",k(r,s)?"Eligible":"Not Eligible"]},s.id))})]})})})})]},r.workerId)),C.length===0&&e.jsx(d,{children:e.jsxs(i,{colSpan:5,align:"center",sx:{py:3},children:["No workers assigned yet. Click ",e.jsx("b",{children:"Assign Competencies"})," to start."]})})]})]})})]}),e.jsxs(Q,{open:T,onClose:()=>n(!1),fullWidth:!0,maxWidth:"sm",children:[e.jsxs(V,{sx:{backgroundColor:"#0A3A6E",color:"white",fontWeight:600,py:3,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[h?"Edit Worker Competencies":"Assign Competencies",e.jsx(m,{onClick:()=>n(!1),sx:{color:"#fff"},children:e.jsx($,{})})]}),e.jsx(X,{dividers:!0,children:e.jsxs(p,{spacing:2,children:[e.jsxs(ee,{value:t.workerId,onChange:r=>c(s=>({...s,workerId:r.target.value})),displayEmpty:!0,fullWidth:!0,children:[e.jsx(W,{value:"",children:"Select Worker"}),I.map(r=>e.jsxs(W,{value:r.id,children:[r.name," (",r.id,")"]},r.id))]}),e.jsx(l,{variant:"subtitle2",children:"Competencies"}),e.jsx(re,{row:!0,children:y.map(r=>e.jsx(se,{control:e.jsx(oe,{checked:t.competencies.includes(r.key),onChange:()=>M(r.key)}),label:r.label},r.key))})]})}),e.jsxs(Z,{children:[e.jsx(j,{onClick:()=>n(!1),sx:{color:"#D32F2F"},children:"Cancel"}),e.jsx(j,{variant:"contained",onClick:v,sx:{backgroundColor:"#0A3A6E"},children:"Save"})]})]})]})}export{Be as default};
