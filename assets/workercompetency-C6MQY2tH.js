import{r as t,j as e,R}from"./index-lQRenEQZ.js";import{B as E,C as F,T as l,a as B,b as q,c as d,d as i,e as H}from"./TableRow-DOrBXlsl.js";import{C as O}from"./CardHeader-CVfYXhzf.js";import{B as h}from"./Modal-B5kKy10H.js";import{A as L}from"./Add-Benailh8.js";import{C as N}from"./CardContent-B105ua6l.js";import{I as j}from"./IconButton-T04wkc8J.js";import{E as U}from"./ExpandLess-DZ7dPrMJ.js";import{E as Y}from"./ExpandMore-CUYkeq_0.js";import{S as m}from"./Stack-CbGqEpRV.js";import{T as _}from"./Tooltip-C8n5BAva.js";import{C as z}from"./Chip-Ds2TcdWV.js";import{E as G}from"./Edit-C-2-cLNF.js";import{D as K}from"./Delete-CGINWn67.js";import{C as J}from"./Collapse-BxTKEx5z.js";import{D as Q,a as V,b as X,c as Z}from"./DialogTitle-BY4vkXbS.js";import{S as $}from"./Select-BG3pRAtK.js";import{M as W}from"./MenuItem-C9agow_O.js";import{F as ee}from"./FormGroup-CY1_CVYF.js";import{F as re}from"./FormControlLabel-D4MRGypc.js";import{C as se}from"./Checkbox-DKIuKd5p.js";import"./clsx-B-dksMZM.js";import"./ButtonBase-DbGEVCCx.js";import"./TransitionGroupContext-Cr6fGhL9.js";import"./Transition-CaP-LOaf.js";import"./index-BGy4LR6Y.js";import"./Popper-C5zl9EtA.js";import"./dividerClasses-HdBjWpbl.js";import"./SwitchBase-D_N6ZnYA.js";const oe=[{id:"PTW-001",name:"Hot Work",requiredChecks:["gasTest","ppe"]},{id:"PTW-002",name:"Confined Space",requiredChecks:["gasTest","isolationCert"]},{id:"PTW-003",name:"Work at Height",requiredChecks:["ppe"]},{id:"PTW-004",name:"Electrical Work",requiredChecks:["ppe"]},{id:"PTW-005",name:"Excavation",requiredChecks:["gasTest","isolationCert"]},{id:"PTW-006",name:"Lifting Operations",requiredChecks:["ppe"]}],I=[{id:"W001",name:"John Doe"},{id:"W002",name:"Priya Sahoo"},{id:"W003",name:"Amit Patel"}],y=[{key:"gasTest",label:"Gas Test"},{key:"isolationCert",label:"Isolation Certificate"},{key:"ppe",label:"PPE Check"}];function Pe(){const[C,p]=t.useState([]),[T,a]=t.useState(!1),[x,u]=t.useState(null),[g,S]=t.useState({}),[n,c]=t.useState({workerId:"",competencies:[]}),w=()=>{u(null),c({workerId:"",competencies:[]}),a(!0)},A=r=>{u(r.workerId),c({workerId:r.workerId,competencies:r.competencies}),a(!0)},D=r=>{window.confirm("Delete this worker?")&&p(s=>s.filter(o=>o.workerId!==r))},M=r=>{c(s=>{const o=new Set(s.competencies);return o.has(r)?o.delete(r):o.add(r),{...s,competencies:Array.from(o)}})},v=()=>{var s;if(!n.workerId)return alert("Select a Worker");const r={workerId:n.workerId,name:((s=I.find(o=>o.id===n.workerId))==null?void 0:s.name)||"",competencies:n.competencies};p(x?o=>o.map(b=>b.workerId===x?r:b):o=>[...o,r]),a(!1)},f=t.useMemo(()=>{const r={};return y.forEach(s=>r[s.key]=s.label),r},[]),k=(r,s)=>s.requiredChecks.every(o=>r.competencies.includes(o)),P=r=>{S(s=>({...s,[r]:!s[r]}))};return e.jsxs(E,{sx:{p:3},children:[e.jsxs(F,{sx:{borderLeft:"6px solid #082A52",boxShadow:"0 6px 18px rgba(0,0,0,0.12)",borderRadius:2},children:[e.jsx(O,{title:e.jsx(l,{variant:"h6",sx:{color:"#0E4C92",fontWeight:600},children:"Worker & Competency Manager"}),action:e.jsx(h,{variant:"contained",startIcon:e.jsx(L,{}),onClick:w,sx:{backgroundColor:"#0A3A6E"},children:"Assign Competencies"})}),e.jsx(N,{children:e.jsxs(B,{children:[e.jsx(q,{children:e.jsxs(d,{sx:{background:"#E3F2FD"},children:[e.jsx(i,{}),e.jsx(i,{children:"Worker ID"}),e.jsx(i,{children:"Name"}),e.jsx(i,{children:"Competencies"}),e.jsx(i,{align:"center",children:"Actions"})]})}),e.jsxs(H,{children:[C.map(r=>e.jsxs(R.Fragment,{children:[e.jsxs(d,{children:[e.jsx(i,{children:e.jsx(j,{size:"small",onClick:()=>P(r.workerId),children:g[r.workerId]?e.jsx(U,{}):e.jsx(Y,{})})}),e.jsx(i,{children:r.workerId}),e.jsx(i,{children:r.name}),e.jsx(i,{children:e.jsxs(m,{direction:"row",spacing:.5,flexWrap:"wrap",children:[r.competencies.length===0&&e.jsx(l,{variant:"body2",sx:{color:"#64748B"},children:"None"}),r.competencies.map(s=>e.jsx(_,{title:f[s],children:e.jsx(z,{label:f[s],size:"small",sx:{mb:.5}})},s))]})}),e.jsx(i,{align:"center",children:e.jsxs(m,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(j,{color:"primary",onClick:()=>A(r),children:e.jsx(G,{})}),e.jsx(j,{color:"error",onClick:()=>D(r.workerId),children:e.jsx(K,{})})]})})]}),e.jsx(d,{children:e.jsx(i,{style:{paddingBottom:0,paddingTop:0},colSpan:5,children:e.jsx(J,{in:g[r.workerId],timeout:"auto",unmountOnExit:!0,children:e.jsxs(E,{sx:{margin:1},children:[e.jsx(l,{variant:"subtitle2",sx:{mb:1},children:"Permit Eligibility"}),e.jsx(m,{spacing:1,children:oe.map(s=>e.jsxs(l,{sx:{color:k(r,s)?"green":"red",fontWeight:600},children:[s.name,": ",k(r,s)?"Eligible":"Not Eligible"]},s.id))})]})})})})]},r.workerId)),C.length===0&&e.jsx(d,{children:e.jsxs(i,{colSpan:5,align:"center",sx:{py:3},children:["No workers assigned yet. Click ",e.jsx("b",{children:"Assign Competencies"})," to start."]})})]})]})})]}),e.jsxs(Q,{open:T,onClose:()=>a(!1),fullWidth:!0,maxWidth:"sm",children:[e.jsx(V,{sx:{backgroundColor:"#0A3A6E",color:"white",fontWeight:600,py:3},children:x?"Edit Worker Competencies":"Assign Competencies"}),e.jsx(X,{dividers:!0,children:e.jsxs(m,{spacing:2,children:[e.jsxs($,{value:n.workerId,onChange:r=>c(s=>({...s,workerId:r.target.value})),displayEmpty:!0,fullWidth:!0,children:[e.jsx(W,{value:"",children:"Select Worker"}),I.map(r=>e.jsxs(W,{value:r.id,children:[r.name," (",r.id,")"]},r.id))]}),e.jsx(l,{variant:"subtitle2",children:"Competencies"}),e.jsx(ee,{row:!0,children:y.map(r=>e.jsx(re,{control:e.jsx(se,{checked:n.competencies.includes(r.key),onChange:()=>M(r.key)}),label:r.label},r.key))})]})}),e.jsxs(Z,{children:[e.jsx(h,{onClick:()=>a(!1),sx:{color:"#D32F2F"},children:"Cancel"}),e.jsx(h,{variant:"contained",onClick:v,sx:{backgroundColor:"#0A3A6E"},children:"Save"})]})]})]})}export{Pe as default};
