import{r as t,j as e,R}from"./index-BGNTJdXh.js";import{B as E,C as F,T as l,a as B,b as q,c as H,d,e as i,f as O}from"./TableRow-C4o90wkq.js";import{C as L,S as m}from"./Stack-E8fi16_w.js";import{B as h}from"./Modal-ZZY8XqvI.js";import{A as N}from"./Add-Gh8GPDgX.js";import{I as j,D as U}from"./Delete-DvimuwFG.js";import{E as Y}from"./ExpandLess-3XU0JU8V.js";import{E as _}from"./ExpandMore-3plVUnV7.js";import{T as z}from"./Tooltip-DjVTl5tL.js";import{C as G}from"./Chip-DmP6IT89.js";import{E as K}from"./Edit-BfV3dxxs.js";import{C as J}from"./Collapse-Ba7q6z5A.js";import{D as Q,a as V,b as X,c as Z}from"./DialogTitle-DPXgBb11.js";import{S as $}from"./Select-F_BpfjE_.js";import{M as W}from"./MenuItem-L2i8Rv4e.js";import{F as ee}from"./FormGroup-CM5UrHyN.js";import{F as se}from"./FormControlLabel-4yk29kAa.js";import{C as re}from"./Checkbox-CWbUzjjm.js";import"./clsx-B-dksMZM.js";import"./Transition-DLxW4k6f.js";import"./index-Czq5OslL.js";import"./Popper-C5oC5a0w.js";import"./SwitchBase-k748bBCE.js";const oe=[{id:"PTW-001",name:"Hot Work",requiredChecks:["gasTest","ppe"]},{id:"PTW-002",name:"Confined Space",requiredChecks:["gasTest","isolationCert"]},{id:"PTW-003",name:"Work at Height",requiredChecks:["ppe"]},{id:"PTW-004",name:"Electrical Work",requiredChecks:["ppe"]},{id:"PTW-005",name:"Excavation",requiredChecks:["gasTest","isolationCert"]},{id:"PTW-006",name:"Lifting Operations",requiredChecks:["ppe"]}],I=[{id:"W001",name:"John Doe"},{id:"W002",name:"Priya Sahoo"},{id:"W003",name:"Amit Patel"}],y=[{key:"gasTest",label:"Gas Test"},{key:"isolationCert",label:"Isolation Certificate"},{key:"ppe",label:"PPE Check"}];function Se(){const[u,p]=t.useState([]),[T,a]=t.useState(!1),[x,C]=t.useState(null),[g,S]=t.useState({}),[n,c]=t.useState({workerId:"",competencies:[]}),w=()=>{C(null),c({workerId:"",competencies:[]}),a(!0)},A=s=>{C(s.workerId),c({workerId:s.workerId,competencies:s.competencies}),a(!0)},D=s=>{window.confirm("Delete this worker?")&&p(r=>r.filter(o=>o.workerId!==s))},M=s=>{c(r=>{const o=new Set(r.competencies);return o.has(s)?o.delete(s):o.add(s),{...r,competencies:Array.from(o)}})},v=()=>{var r;if(!n.workerId)return alert("Select a Worker");const s={workerId:n.workerId,name:((r=I.find(o=>o.id===n.workerId))==null?void 0:r.name)||"",competencies:n.competencies};p(x?o=>o.map(b=>b.workerId===x?s:b):o=>[...o,s]),a(!1)},k=t.useMemo(()=>{const s={};return y.forEach(r=>s[r.key]=r.label),s},[]),f=(s,r)=>r.requiredChecks.every(o=>s.competencies.includes(o)),P=s=>{S(r=>({...r,[s]:!r[s]}))};return e.jsxs(E,{sx:{p:3},children:[e.jsxs(F,{sx:{borderLeft:"6px solid #082A52",boxShadow:"0 6px 18px rgba(0,0,0,0.12)",borderRadius:2},children:[e.jsx(L,{title:e.jsx(l,{variant:"h6",sx:{color:"#0E4C92",fontWeight:600},children:"Worker & Competency Manager"}),action:e.jsx(h,{variant:"contained",startIcon:e.jsx(N,{}),onClick:w,sx:{backgroundColor:"#0A3A6E"},children:"Assign Competencies"})}),e.jsx(B,{children:e.jsxs(q,{children:[e.jsx(H,{children:e.jsxs(d,{sx:{background:"#E3F2FD"},children:[e.jsx(i,{}),e.jsx(i,{children:"Worker ID"}),e.jsx(i,{children:"Name"}),e.jsx(i,{children:"Competencies"}),e.jsx(i,{align:"center",children:"Actions"})]})}),e.jsxs(O,{children:[u.map(s=>e.jsxs(R.Fragment,{children:[e.jsxs(d,{children:[e.jsx(i,{children:e.jsx(j,{size:"small",onClick:()=>P(s.workerId),children:g[s.workerId]?e.jsx(Y,{}):e.jsx(_,{})})}),e.jsx(i,{children:s.workerId}),e.jsx(i,{children:s.name}),e.jsx(i,{children:e.jsxs(m,{direction:"row",spacing:.5,flexWrap:"wrap",children:[s.competencies.length===0&&e.jsx(l,{variant:"body2",sx:{color:"#64748B"},children:"None"}),s.competencies.map(r=>e.jsx(z,{title:k[r],children:e.jsx(G,{label:k[r],size:"small",sx:{mb:.5}})},r))]})}),e.jsx(i,{align:"center",children:e.jsxs(m,{direction:"row",spacing:1,justifyContent:"center",children:[e.jsx(j,{color:"primary",onClick:()=>A(s),children:e.jsx(K,{})}),e.jsx(j,{color:"error",onClick:()=>D(s.workerId),children:e.jsx(U,{})})]})})]}),e.jsx(d,{children:e.jsx(i,{style:{paddingBottom:0,paddingTop:0},colSpan:5,children:e.jsx(J,{in:g[s.workerId],timeout:"auto",unmountOnExit:!0,children:e.jsxs(E,{sx:{margin:1},children:[e.jsx(l,{variant:"subtitle2",sx:{mb:1},children:"Permit Eligibility"}),e.jsx(m,{spacing:1,children:oe.map(r=>e.jsxs(l,{sx:{color:f(s,r)?"green":"red",fontWeight:600},children:[r.name,": ",f(s,r)?"Eligible":"Not Eligible"]},r.id))})]})})})})]},s.workerId)),u.length===0&&e.jsx(d,{children:e.jsxs(i,{colSpan:5,align:"center",sx:{py:3},children:["No workers assigned yet. Click ",e.jsx("b",{children:"Assign Competencies"})," to start."]})})]})]})})]}),e.jsxs(Q,{open:T,onClose:()=>a(!1),fullWidth:!0,maxWidth:"sm",children:[e.jsx(V,{sx:{backgroundColor:"#0A3A6E",color:"white",fontWeight:600,py:3},children:x?"Edit Worker Competencies":"Assign Competencies"}),e.jsx(X,{dividers:!0,children:e.jsxs(m,{spacing:2,children:[e.jsxs($,{value:n.workerId,onChange:s=>c(r=>({...r,workerId:s.target.value})),displayEmpty:!0,fullWidth:!0,children:[e.jsx(W,{value:"",children:"Select Worker"}),I.map(s=>e.jsxs(W,{value:s.id,children:[s.name," (",s.id,")"]},s.id))]}),e.jsx(l,{variant:"subtitle2",children:"Competencies"}),e.jsx(ee,{row:!0,children:y.map(s=>e.jsx(se,{control:e.jsx(re,{checked:n.competencies.includes(s.key),onChange:()=>M(s.key)}),label:s.label},s.key))})]})}),e.jsxs(Z,{children:[e.jsx(h,{onClick:()=>a(!1),sx:{color:"#D32F2F"},children:"Cancel"}),e.jsx(h,{variant:"contained",onClick:v,sx:{backgroundColor:"#0A3A6E"},children:"Save"})]})]})]})}export{Se as default};
